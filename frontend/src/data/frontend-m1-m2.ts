import type { Lesson } from '../types';

export const frontendM1M2: Lesson[] = [
    {
        id: 'fe-1-1', type: 'frontend',
        title: 'è¯¾ç¨‹ 1.1ï¼šé…ç½® SaaS é¡¹ç›®çš„ React å¤–å£³',
        category: 'æ¨¡å—1ï¼šç°ä»£åŸºç¡€æ¶æ„ä¸æƒé™', track: 'å‰ç«¯æ¶æ„',
        moduleNumber: 1, lessonNumber: 1, language: 'typescript',
        startingCode: '',
        instructions: `# é…ç½® SaaS é¡¹ç›®çš„ React å¤–å£³ä¸ä»£ç†æœºåˆ¶

## ğŸ¯ ä¸šåŠ¡ä¸Šä¸‹æ–‡ä¸æˆ‘ä»¬åœ¨åšä»€ä¹ˆï¼Ÿ
åœ¨å¼€å¯â€œçŸ­è§†é¢‘ SaaS çœ‹æ¿â€çš„ä¸šåŠ¡ä»£ç ç¼–å†™å‰ï¼Œåšå®çš„åŸºç¡€è®¾æ–½æ˜¯æˆåŠŸçš„ä¿éšœã€‚æœ¬å¹³å°é€‰æ‹©äº†æ„å»ºå·¥å…·çš„æ–°ç‹â€”â€”**Vite**ï¼Œç»“åˆäº†ç›®å‰ä¼ä¸šä¸­æœ€æµè¡Œçš„ **React (Hooks)** å¼€å‘èŒƒå¼ï¼Œä»¥åŠ **Tailwind CSS** çš„åŸå­åŒ–è§£å†³æ–¹æ¡ˆã€‚

æˆ‘ä»¬çš„ SaaS åç«¯ï¼ˆSpring Bootï¼‰å°†ä¼šè·‘åœ¨ \`localhost:8080\` ä¸Šã€‚åœ¨å‰åç«¯åˆ†ç¦»æ¶æ„ä¸‹ï¼Œå‰ç«¯ç›´æ¥ç”¨ \`fetch('http://localhost:8080/api')\` ä¼šç«‹åˆ»è§¦å‘æµè§ˆå™¨ä¸¥æ ¼çš„åŒæºç­–ç•¥ï¼ˆSame-Origin Policyï¼‰ï¼Œå¯¼è‡´ CORSï¼ˆè·¨åŸŸèµ„æºå…±äº«ï¼‰æŠ¥é”™ã€‚ä¸å…¶è¦æ±‚åç«¯å»ä¿®æ”¹ç¹ççš„è·¨åŸŸå“åº”å¤´ï¼Œ**æœ€å¥½çš„å·¥ç¨‹å®è·µæ˜¯ï¼šåœ¨å‰ç«¯å¼€å‘æœåŠ¡å™¨ï¼ˆViteï¼‰ä¸­æ‹¦æˆªå¹¶ä»£ç†è¿™äº›è¯·æ±‚**ã€‚

## ğŸ” ä»£ç æ·±åº¦è§£æ
åœ¨æ¥ä¸‹æ¥çš„é…ç½®ä»£ç ä¸­ï¼Œæ³¨æ„è¿™å‡ å¤„å…³é”®é…ç½®ï¼š
- \`resolve.alias\`ï¼šé€šè¿‡ \`@\` åˆ«åï¼Œæˆ‘ä»¬ä»¥åå†ä¹Ÿä¸ç”¨å†™å‡ºå®¹æ˜“å¼•å‘ç¾éš¾çš„ \`../../../../components\` è¿™ç§â€œè¿·å®«è·¯å¾„â€äº†ï¼Œç›´æ¥å†™ \`@/components\`ã€‚
- \`server.proxy\`ï¼šè¿™ä¸ªé…ç½®æŒ‡ä»¤å‘Šè¯‰ Viteï¼Œâ€œæ‰€æœ‰åŒ¹é… \`/api\` çš„è¯·æ±‚ï¼Œä½ éƒ½ä¸è¦è¯•å›¾åœ¨å‰ç«¯çš„æœ¬åœ°æ‰¾æ–‡ä»¶ï¼Œè¯·ä½œä¸ºä¸€åº§é€æ˜çš„æ¡¥ï¼Œç›´æ¥åŸå°ä¸åŠ¨åœ°è½¬å‘ç»™ \`http://localhost:8080\`ã€‚â€
- \`changeOrigin: true\`ï¼šå®ƒä¼šæŠŠå‘å¤–å‘é€è¯·æ±‚æ—¶çš„ \`Host\` è¯·æ±‚å¤´ä¼ªè£…æˆç›®æ ‡æœåŠ¡å™¨ï¼ˆ8080ï¼‰çš„åœ°å€ï¼Œéª—è¿‡å¯èƒ½å­˜åœ¨çš„ç½‘å…³å±‚æ ¡éªŒã€‚

### ğŸ§  åº•å±‚åŸç†å‰–æï¼šVite ä¸ºä»€ä¹ˆæ¯” Webpack å¿«ï¼Ÿä»¥åŠ Proxy åŸç†
**Vite vs Webpack**ï¼š
åœ¨ Webpack æ—¶ä»£ï¼Œæ— è®ºä½ æ”¹äº†ä¸€è¡Œ CSS è¿˜æ˜¯åŠ äº†ä¸€ä¸ªç»„ä»¶ï¼Œå®ƒéƒ½å¿…é¡»åœ¨å†…å­˜ä¸­æŠŠæ•´ä¸ªé¡¹ç›®çš„ä¾èµ–æ ‘ä»å¤´åˆ°å°¾**æ‰“åŒ…ï¼ˆBundleï¼‰**ä¸€éï¼Œå†åç»™æµè§ˆå™¨ï¼Œè¿™åœ¨å·¨å‹é¡¹ç›®ä¸­å¯èƒ½ä¼šè€—æ—¶å‡ åç§’ã€‚è€Œ Vite åˆ©ç”¨äº†ç°ä»£æµè§ˆå™¨å¤©ç„¶æ”¯æŒåŸç”Ÿ **ESM (ECMAScript Modules)** çš„ç‰¹æ€§ã€‚
å½“ä½ åœ¨æµè§ˆå™¨é‡Œè¯·æ±‚ \`import { App } from './App.js'\` æ—¶ï¼ŒVite ä½œä¸ºä¸€ä¸ªæä¸ºè½»é‡çš„ HTTP æœåŠ¡å™¨ï¼Œæ‹¦æˆªåˆ°è¿™ä¸ªè¯·æ±‚ï¼Œç„¶åä»…ç¼–è¯‘ \`App.js\` è¿™ä¸€å¼ å¡ç‰‡ï¼ˆä¸å«å¤–éƒ¨ä¾èµ–ï¼Œå¤–éƒ¨ä½¿ç”¨æµè§ˆå™¨ç¼“å­˜ï¼‰å‘é€ç»™å‰ç«¯ã€‚è¿™ç§**æŒ‰éœ€ç¼–è¯‘**è®©å®ƒæ— è®ºé¡¹ç›®å¤šå¤§ï¼Œå¯åŠ¨æ—¶é—´æ°¸è¿œæ˜¯æ¯«ç§’çº§ã€‚

**Proxy çš„æœ¬è´¨**ï¼š
CORSï¼ˆè·¨åŸŸï¼‰æ˜¯**æµè§ˆå™¨**ä¸ºäº†ä¿æŠ¤ç”¨æˆ·ä¸å— CSRF æ”»å‡»è€Œè®¾ç«‹çš„åŸå¢™ã€‚åç«¯çš„ Java ç¨‹åºã€Vite è¿è¡Œæ‰€åœ¨çš„ Node.js ç¯å¢ƒï¼Œæ˜¯æ²¡æœ‰äº’ç›¸è·¨åŸŸé™åˆ¶çš„ã€‚Vite çš„ \`server.proxy\` å°±æ˜¯åˆ©ç”¨äº†è¿™ä¸€ç‚¹ï¼šæµè§ˆå™¨ä»¥ä¸ºå®ƒæ˜¯åŒæºè¯·æ±‚å‘ç»™äº† Vite (è¿è¡Œåœ¨ \`localhost:5173\`)ï¼ŒVite çš„ Node.js åº•å±‚å†å‘èµ·ä¸€ä¸ªçº¯å‡€çš„ HTTP TCP è¯·æ±‚å‘ç»™å†…ç½‘çš„ Javaã€‚æµè§ˆå™¨ä¸çŸ¥æƒ…ï¼Œè·¨åŸŸé—®é¢˜å°±æ­¤å®Œç¾è§£å†³ã€‚`,
        targetCode: `import { defineConfig } from 'vite';\nimport react from '@vitejs/plugin-react';\nimport tailwindcss from '@tailwindcss/vite';\nimport path from 'path';\n\nexport default defineConfig({\n  plugins: [\n    react(),\n    tailwindcss(),\n  ],\n  resolve: {\n    alias: {\n      // ğŸ’¡ è·¯å¾„åˆ«åï¼šè®©ä½ åœ¨ä»£ç é‡Œä½¿ç”¨ '@/components' è€Œä¸æ˜¯ '../../components'\n      '@': path.resolve(__dirname, './src'),\n    },\n  },\n  server: {\n    port: 5173,\n    proxy: {\n      // ğŸ’¡ ä»£ç†é…ç½®ï¼šè¿™è§£å†³è”è°ƒæ—¶æœ€å¸¸è§çš„ CORS è·¨åŸŸé—®é¢˜\n      // æ‰€æœ‰ /api å¼€å¤´çš„è¯·æ±‚éƒ½ä¼šè¢«é€æ˜è½¬å‘ç»™ Spring Boot åç«¯\n      '/api': {\n        target: 'http://localhost:8080',\n        changeOrigin: true,\n      },\n    },\n  },\n});\n`,
        comments: [
            { line: 13, text: '// ğŸ’¡ è®©æ·±å±‚ç›®å½•å¼•å…¥å˜å¾—ä¼˜é›…' },
            { line: 20, text: '// ğŸ’¡ æ‹¦æˆª /api è¯·æ±‚' },
            { line: 24, text: '// ğŸ’¡ ä¼ªè£…æˆè¯·æ±‚åç«¯çš„ç›®æ ‡åŸŸåï¼Œé¿å¼€ CORS' },
        ],
    },
    {
        id: 'fe-1-2', type: 'frontend',
        title: 'è¯¾ç¨‹ 1.2ï¼šç±»å‹ä¸¥æ ¼çš„ JWT ç™»å½•è¡¨å•',
        category: 'æ¨¡å—1ï¼šç°ä»£åŸºç¡€æ¶æ„ä¸æƒé™', track: 'å‰ç«¯æ¶æ„',
        moduleNumber: 1, lessonNumber: 2, language: 'typescript',
        startingCode: '',
        instructions: `# æ‰“é€ ä¼ä¸šçº§å¼ºç±»å‹ JWT ç™»å½•è¡¨å•

## ğŸ¯ ä¸šåŠ¡ä¸Šä¸‹æ–‡ä¸æˆ‘ä»¬åœ¨åšä»€ä¹ˆï¼Ÿ
SaaS ç³»ç»Ÿçš„ç¬¬ä¸€é“å¤§é—¨å°±æ˜¯ç™»å½•è®¤è¯ã€‚ç”¨æˆ·è¾“å…¥è´¦å·å¯†ç åï¼Œæˆ‘ä»¬ä¼šè°ƒç”¨è®¤è¯ APIï¼Œè€Œåç«¯é€šå¸¸ä¼šè¿”å›ä¸€ä¸ªå«æœ‰èº«ä»½éªŒè¯ä¿¡æ¯çš„ **JWT (JSON Web Token)** ä»¥åŠè¯¥ç”¨æˆ·çš„è§’è‰²ã€‚
åœ¨æ²¡æœ‰ TypeScript çš„æ—¶ä»£ï¼Œå¦‚æœåç«¯å°† \`userId\` æ”¹åå« \`user_id\`ï¼Œç›´åˆ°ä½ çš„ç¨‹åºå´©æºƒå‰ï¼Œä½ éƒ½ä¸ä¼šå¯Ÿè§‰ã€‚åœ¨æœ¬æ¬¡è¯¾ç¨‹ä¸­ï¼Œæˆ‘ä»¬è¦å­¦ä¹ å¦‚ä½•å»ºç«‹**å‰åç«¯çš„å¥‘çº¦ï¼ˆInterfaceï¼‰**ï¼Œä»¥åŠå¦‚ä½•åœ¨ React Hook ä¸­ä½¿ç”¨æ³›å‹æ¥æ­»æ­»é’³ä½å¼‚å¸¸çŠ¶æ€ã€‚

## ğŸ” ä»£ç æ·±åº¦è§£æ
- **\`LoginResponse\` æ¥å£**ï¼šè¿™å°±æ˜¯å‰åç«¯çš„é˜²çº¿ã€‚åªè¦è¿™å±‚å¥‘çº¦å†™æ¸…æ¥šäº†ï¼Œåé¢çš„æ¯ä¸€æ¬¡ \`data.user.role\` æå–éƒ½ä¼šå¾—åˆ° IDE å®Œç¾çš„ä»£ç è¡¥å…¨ã€‚
- **\`useState<T>\`**ï¼šè¿™é‡Œæˆ‘ä»¬ç”¨æ³›å‹æ˜¾å¼çº¦æŸäº† error åªèƒ½æ˜¯åŸç”Ÿ \`Error\` å¯¹è±¡æˆ– \`null\`ã€‚å¦‚æœä¸å£°æ˜ï¼ŒReact ä¼šæŠŠå®ƒè‡ªåŠ¨æ¨å¯¼ä¸º \`any\`ï¼Œè¿™åœ¨å¤§å‹ç³»ç»Ÿä¸­æ˜¯è‡´å‘½çš„ã€‚
- **\`e: React.FormEvent\`**ï¼šåœ¨ç›‘å¬ Submit æ—¶ï¼Œå¦‚æœæˆ‘ä»¬æ‹¦æˆª \`e.preventDefault()\`ï¼Œå¿…é¡»å‘Šè¯‰ TS è¿™æ˜¯ä¸€ä¸ªè¡¨å•äº‹ä»¶ï¼Œå®ƒæ‰ä¼šæ”¾è¡Œè¿™ä¸ªæ–¹æ³•è°ƒç”¨ã€‚
- **\`localStorage.setItem\`**ï¼šæ‹¿åˆ°çš„ä»¤ç‰Œæˆ‘ä»¬ä¼šå­˜å‚¨åœ¨æµè§ˆå™¨çš„æœ¬åœ°é•¿æœŸå‚¨å­˜ä¸­ï¼Œä»¥ä¾¿åç»­è¯·æ±‚å¯ä»¥æŒ‚è½½ã€‚

### ğŸ§  åº•å±‚åŸç†å‰–æï¼šReact äº‹ä»¶åˆæˆä¸ JWT ç»“æ„
**React çš„åˆæˆäº‹ä»¶ç³»ç»Ÿï¼ˆSyntheticEventï¼‰**ï¼š
ä¸ºä»€ä¹ˆæˆ‘ä»¬è¦ç”¨ \`React.FormEvent\` è€Œä¸æ˜¯æµè§ˆå™¨åŸç”Ÿçš„ \`SubmitEvent\`ï¼Ÿä¸ºäº†æŠ¹å¹³ä¸åŒæµè§ˆå™¨ï¼ˆChromeã€Safariã€è€æ—§ IEï¼‰å¯¹äº‹ä»¶å¤„ç†çš„æ•°åç§å·®å¼‚ï¼ŒReact å¼•æ“è‡ªå·±å†™äº†ä¸€ä¸ªä¸­é—´å±‚ã€‚å½“ä½ å†™ä¸‹ \`onSubmit\` æ—¶ï¼ŒReact å¹¶æ²¡æœ‰åœ¨è¿™ä¸ª \`form\` æ ‡ç­¾ä¸Šç»‘å®šåŸç”Ÿç›‘å¬ï¼Œè€Œæ˜¯æŠŠç³»ç»Ÿæ‰€æœ‰çš„äº‹ä»¶éƒ½ç»Ÿä¸€æŒ‚è½½åˆ°äº† \`document\` æˆ–åº”ç”¨ \`root\` æ ¹èŠ‚ç‚¹ä¸Šï¼ˆäº‹ä»¶å§”æ‰˜ï¼‰ã€‚ä¼ å…¥çš„ \`e\` ä¹Ÿæ˜¯ä¸€ä¸ªè¢« React åŒ…è£…è¿‡çš„å®‰å…¨è·¨æµè§ˆå™¨å¯¹è±¡ã€‚

**JWT çš„æ— çŠ¶æ€é­”æ³•**ï¼š
Token æ”¾åœ¨å‰ç«¯ä¸ºä»€ä¹ˆæ˜¯å®‰å…¨çš„ï¼ŸJWT åˆ†ä¸ºä¸‰æ®µï¼šå¤´éƒ¨ï¼ˆç®—æ³•è¯´æ˜ï¼‰ã€è´Ÿè½½ï¼ˆé‡Œé¢æ˜æ–‡å­˜å‚¨äº†ä½ çš„ username å’Œ role ç­‰ä¿¡æ¯ï¼Œä¸å¯æ”¾å¯†ç ï¼‰ã€ç­¾åï¼ˆSignatureï¼‰ã€‚
ç­¾åæ˜¯ç”±åç«¯ç”¨ä¸€ä¸ªé™¤äº†å®ƒæ²¡äººçŸ¥é“çš„ç§˜é’¥ï¼ˆSecretï¼‰æŠŠå‰ä¸¤éƒ¨åˆ†è¿›è¡Œå“ˆå¸Œç®—å‡ºæ¥çš„æ ¡éªŒç ã€‚å¦‚æœä½ åœ¨å‰ç«¯æŠŠè§’è‰²ä¹Ÿå°±æ˜¯è´Ÿè½½éƒ¨åˆ†ä» \`USER\` ç¯¡æ”¹æˆ \`ADMIN\`ï¼Œé‚£ä¼šå¯¼è‡´å®ƒå’Œç¬¬ä¸‰æ®µç­¾åä¸åŒ¹é…ï¼Œå½“ä½ åœ¨ä¸‹ä¸€æ¬¡è¯·æ±‚æ—¶å‘å›ç»™åç«¯ï¼Œåç«¯éªŒç­¾ç«‹åˆ»å¤±è´¥ã€‚å› ä¸ºæ— æ³•éªŒç­¾ï¼Œæˆ‘ä»¬å®ç°äº†**æ— éœ€åœ¨åç«¯å†…å­˜ä¿å­˜â€œè°åœ¨çº¿â€çš„çŠ¶æ€**ä¹Ÿèƒ½éªŒè¯æ‰€æœ‰ç”¨æˆ·ï¼Œè¿™éå¸¸åˆ©äºå¾®æœåŠ¡æœºå™¨é›†ç¾¤çš„æ¨ªå‘æ‰©å®¹ã€‚`,
        targetCode: `import React, { useState } from 'react';\n\n// ğŸ’¡ æ¥å£å®šä¹‰äº†åç«¯çš„æ‰¿è¯ºï¼Œè¿™æ˜¯å…¨æ ˆè”è°ƒæ—¶å‰åç«¯æ²Ÿé€šçš„å¥‘çº¦\ninterface LoginResponse {\n  token: string;\n  user: {\n    id: string;\n    username: string;\n    role: 'ADMIN' | 'USER';\n  };\n}\n\nconst LoginForm: React.FC = () => {\n  const [username, setUsername] = useState<string>('');\n  const [password, setPassword] = useState<string>('');\n  // ğŸ’¡ æ³›å‹çº¦æŸï¼šçŠ¶æ€åªèƒ½æ˜¯ Error å¯¹è±¡æˆ– null\n  const [error, setError] = useState<Error | null>(null);\n\n  // ğŸ’¡ æ˜ç¡®å£°æ˜è¿™æ˜¯è¡¨å•çš„æäº¤äº‹ä»¶ï¼Œè·å¾— e.preventDefault() çš„ç±»å‹æ¨å¯¼\n  const handleLogin = async (e: React.FormEvent<HTMLFormElement>) => {\n    e.preventDefault();\n    try {\n      const res = await fetch('/api/auth/login', {\n        method: 'POST',\n        headers: { 'Content-Type': 'application/json' },\n        body: JSON.stringify({ username, password }),\n      });\n      // ğŸ’¡ å¼ºè½¬ç±»å‹ï¼šæˆ‘ä»¬å‘Šè¯‰ç¼–è¯‘å™¨ï¼Œâ€œç›¸ä¿¡æˆ‘ï¼Œè¿”å›å€¼ç¬¦åˆ LoginResponse ç»“æ„â€\n      const data = (await res.json()) as LoginResponse;\n      localStorage.setItem('jwt', data.token);\n    } catch (err) {\n      setError(err instanceof Error ? err : new Error('Login failed'));\n    }\n  };\n\n  return (\n    <form onSubmit={handleLogin} className="p-6 bg-white shadow-md rounded-xl">\n      {error && <p className="text-red-500 mb-4">{error.message}</p>}\n      <input className="block border p-2 mb-2 w-full" type="text" placeholder="Username"\n        value={username} onChange={e => setUsername(e.target.value)} />\n      <input className="block border p-2 mb-4 w-full" type="password" placeholder="Password"\n        value={password} onChange={e => setPassword(e.target.value)} />\n      <button type="submit" className="w-full bg-blue-600 text-white p-2 rounded hover:bg-blue-700">ç™»å½•</button>\n    </form>\n  );\n};\n\nexport default LoginForm;`,
        comments: [
            { line: 3, text: '// ğŸ’¡ å¥‘çº¦ï¼šå®šä¹‰åç«¯è¿”å›çš„æ•°æ®ç»“æ„' },
            { line: 13, text: '// ğŸ’¡ ä¸ºå‡½æ•°ç»„ä»¶æ·»åŠ ç±»å‹å£°æ˜' },
            { line: 16, text: '// ğŸ’¡ å¼ºç±»å‹é˜²æ­¢æ»¥ç”¨å…¶ä»–æ•°æ®ç±»å‹' },
            { line: 19, text: '// ğŸ’¡ React ä¸“å±çš„äº‹ä»¶ç±»å‹' },
            { line: 28, text: '// ğŸ’¡ æ–­è¨€ï¼šå°†æœªçŸ¥çš„ any å‹è½¬åŒ–ä¸ºé¢„è®¾çš„ç»“æ„' },
        ],
    },
    {
        id: 'fe-1-3', type: 'frontend',
        title: 'è¯¾ç¨‹ 1.3ï¼šå¤„ç†è®¤è¯çš„å¼‚æ­¥çŠ¶æ€æœº',
        category: 'æ¨¡å—1ï¼šç°ä»£åŸºç¡€æ¶æ„ä¸æƒé™', track: 'å‰ç«¯æ¶æ„',
        moduleNumber: 1, lessonNumber: 3, language: 'typescript',
        startingCode: '',
        instructions: `# åˆ©ç”¨å¯åŒºåˆ†è”åˆä½“æ„å»ºå¼‚æ­¥çŠ¶æ€æœº

## ğŸ¯ ä¸šåŠ¡ä¸Šä¸‹æ–‡ä¸æˆ‘ä»¬åœ¨åšä»€ä¹ˆï¼Ÿ
åœ¨å¤„ç†ç½‘ç»œè¯·æ±‚æ—¶ï¼Œé¡µé¢å¯èƒ½ä¼šå› ä¸ºç½‘ç»œæŠ–åŠ¨å¡ä½æ•°ç§’ã€‚å¦‚æœä¸å±•ç¤º Loading å›¾æ ‡ï¼Œç”¨æˆ·çš„ç»æœ›ç‚¹å‡»ä¼šå¼•å‘ç«æ€é—®é¢˜ã€‚ä¸€èˆ¬çš„åˆå­¦è€…åšæ³•æ˜¯éšæ„å£°æ˜ \`isLoading: boolean\`ï¼Œ\`data: any\` å’Œ \`error: string\`ï¼Œè¿™éå¸¸å®¹æ˜“äº§ç”Ÿâ€œéæ³•çŠ¶æ€â€ï¼ˆä¾‹å¦‚ \`isLoading: true\` åŒæ—¶ \`data\` ä¹Ÿæœ‰å€¼ï¼Œæˆ–è€…åˆæœ‰ \`data\` åˆæœ‰ \`error\`ï¼‰ã€‚
åˆ©ç”¨ TypeScript ç‰¹æœ‰çš„**å¯åŒºåˆ†è”åˆä½“ï¼ˆDiscriminated Unionsï¼‰**ç†å¿µï¼Œæˆ‘ä»¬å°†é‡æ„æ•´ä¸ªè®¤è¯çŠ¶æ€ï¼Œè®©å…¶åƒä¸€å°çŠ¶æ€æœºèˆ¬æµè½¬ï¼Œä¸ç¬¦åˆå¸¸ç†çš„çŠ¶æ€è¿ç¼–è¯‘éƒ½è¿‡ä¸å»ã€‚

## ğŸ” ä»£ç æ·±åº¦è§£æ
- **\`AuthState\`**ï¼šçœ‹ï¼è¿™é‡Œç”¨ \`|\` ç¬¦å·å¹¶åˆ—äº†å››ç§ç»å¯¹äº’æ–¥çš„ç‹¬ç«‹çŠ¶æ€ç©ºé—´ã€‚ä¸€æ—¦å¯¹è±¡é‡Œçš„ \`status\` æ˜¯ \`'loading'\`ï¼Œé‚£ä¹ˆç¼–è¯‘å™¨ç»å¯¹ä¸å…è®¸ä½ è®¿é—® \`token\` è¿™ä¸ªé”®ï¼Œå› ä¸ºå®ƒè®¤ä¸ºé‚£æ˜¯åªæœ‰å½“ \`status === 'success'\` æ—¶æ‰ä¼šå‡ºç°çš„æ•°æ®ã€‚
- **\`authReducer\`**ï¼šè¿™ç§æ¨¡å¼çµæ„Ÿæ¥æºäº Reduxã€‚å®ƒè§„å®šä½ ä¸èƒ½å†éšä¾¿ç»™æŸäº›å˜é‡èµ‹å€¼ï¼Œæ‰€æœ‰çš„æ”¹å˜å¿…é¡»é€šè¿‡ä¸ŠæŠ¥ \`action\` äº‹ä»¶ï¼ˆæ¯”å¦‚ä¸ŠæŠ¥ä¸€æ¬¡ \`'FETCH'\` è¿™ä¸ªåŠ¨ä½œï¼‰ã€‚æœºå™¨æ ¹æ®è§„åˆ™æ”¶åˆ°æŒ‡ä»¤ï¼Œå®ŒæˆçŠ¶æ€çš„ç»å¯¹å˜å¼‚ã€‚
- **\`useReducer\`**ï¼šæ¯” \`useState\` æ›´é«˜çº§çš„ React Hookï¼Œéå¸¸é€‚åˆå¤„ç†â€œä¸‹ä¸€ä¸ªçŠ¶æ€æä¸ºä¾èµ–ä¸Šä¸€ä¸ªçŠ¶æ€å¹¶ä¸”æ‹¥æœ‰å¤šåˆ†æ”¯é€»è¾‘â€çš„å¤æ‚æƒ…å†µã€‚

### ğŸ§  åº•å±‚åŸç†å‰–æï¼šTS ç±»å‹æ”¶çª„ä¸ React æ¸²æŸ“é˜Ÿåˆ—
**TypeScript ç±»å‹æ”¶çª„ï¼ˆType Narrowingï¼‰æœºåˆ¶**ï¼š
å¯¹äºç¼–è¯‘å™¨è€Œè¨€ï¼Œ\`AuthState\` æ˜¯ä¸€ä¸ªå››æ¡è·¯èµ°å…¶ä¸­ä¸€æ¡çš„å²”å£ã€‚\`status\` å­—æ®µè¢«ç§°ä¸º**åˆ¤åˆ«å±æ€§ï¼ˆDiscriminant Propertyï¼‰**ã€‚
å½“ä½ åœ¨ä»£ç ä¸­å†™å‡ºä¸€å¥ \`if (state.status === 'success')\` æ—¶ï¼ŒTS çš„è¯­æ³•æ ‘æ¨æ–­å™¨ï¼ˆControl Flow Analysisï¼‰ä¼šä»‹å…¥ï¼šå®ƒåœ¨ç¼–è¯‘æœŸåšæ’é™¤æ³•ï¼Œé”æ­»åœ¨è¿™ä¸ª IF å—å†…éƒ¨çš„ä¸Šä¸‹æ–‡ï¼Œæ˜ç¡®å®£å‘Šâ€œç°åœ¨åªå‰©å¸¦ token çš„é‚£ä¸€ä¸ªå½¢çŠ¶äº†â€ï¼Œæ‰€ä»¥ä½ å¯ä»¥è‚†æ— å¿Œæƒ®åœ°å–ç”¨ \`state.token\`ã€‚è¿™å¥—ä½“ç³»æ˜¯å°†é™æ€æ£€æŸ¥åˆ©ç”¨åˆ°æé™çš„ç¥æŠ€ã€‚

**React \`useReducer\` ä¸æ‰¹é‡æ¸²æŸ“**ï¼š
å½“ä½ è¿ç»­è°ƒäº†åæ¬¡ \`setLoading(true)\`ï¼Œ\`setData(xxx)\`ï¼ŒReact æ˜¯å¦ä¼šé‡ç»˜åæ¬¡ DOMï¼Ÿå¹¶ä¸ä¼šã€‚React å†…éƒ¨æœ‰ä¸€å¥—æä¸ºç²¾å¯†çš„æ¸²æŸ“é˜Ÿåˆ—ä¸è°ƒå’Œå™¨ï¼ˆFiber Reconcilerï¼‰ã€‚18 ç‰ˆæœ¬çš„ React æ”¯æŒå…¨é¢**æ‰¹é‡æ›´æ–°ï¼ˆAutomatic Batchingï¼‰**ã€‚
ä½† \`useReducer\` ä»é€»è¾‘æºå¤´ä¸Šå°±æ›´è¿›ä¸€æ­¥ï¼šå®ƒç›´æ¥æŠŠç¦»æ•£çš„æ›´æ–°æ‰æˆäº†å¯¹æ•°æ®ç»“æ„çš„å•ç‚¹å¿«ç…§é‡åˆ¶ï¼ˆSnapshotï¼‰ã€‚å½“ \`dispatch({type: 'SUCCESS'})\` æ‰§è¡Œåï¼Œæ–°çš„ state ç›´æ¥è¦†ç›–æ‰åœ¨ Fiber æ ‘ä¸ŠæŒ‚è½½çš„æ—§èŠ‚ç‚¹çŠ¶æ€ï¼Œé€šè¿‡ç®€å•çš„ Object.is å¯¹æ¯”ï¼Œæå¿«åœ°å†³å®šå‡ºåº”è¯¥åªæ¸²æŸ“é‚£ä¸€éƒ¨åˆ†ç•Œé¢ã€‚`,
        targetCode: `// ğŸ’¡ å¯åŒºåˆ†è”åˆä½“ï¼šstatus æ˜¯é’¥åŒ™ï¼Œå®ƒå†³å®šäº†å¯¹è±¡é‡Œèƒ½å­˜ä»€ä¹ˆæ•°æ®\ntype AuthState =\n  | { status: 'idle' }\n  | { status: 'loading' }\n  | { status: 'success'; token: string }\n  | { status: 'error'; error: string };\n\n// ğŸ’¡ reducer ä»…å…è®¸ä½ è§¦å‘åˆæ³•çš„çŠ¶æ€å˜è¿ï¼Œæ¯”å¦‚ä» FETCH å°±åªèƒ½èµ°å‘ loading\nfunction authReducer(\n  state: AuthState,\n  action: \n    | { type: 'FETCH' }\n    | { type: 'SUCCESS'; token: string }\n    | { type: 'ERROR'; error: string }\n): AuthState {\n  switch (action.type) {\n    case 'FETCH':\n      return { status: 'loading' };\n    case 'SUCCESS':\n      // ğŸ’¡ æ­¤å¤„ TypeScript è¦æ±‚ä½ å¿…é¡»æä¾› tokenï¼Œä¸å¯èƒ½æ¼æ‰\n      return { status: 'success', token: action.token };\n    case 'ERROR':\n      return { status: 'error', error: action.error };\n    default:\n      return state;\n  }\n}\n\n// åœ¨ç»„ä»¶ä¸­ä½¿ç”¨æ¡ˆä¾‹ï¼š\nexport function useAuthMachine() {\n  const [state, dispatch] = React.useReducer(authReducer, { status: 'idle' });\n  // dispatch({ type: 'SUCCESS', token: 'ey...' })\n  return { state, dispatch };\n}\n`,
        comments: [
            { line: 1, text: '// ğŸ’¡ ç”¨åˆ¤åˆ«å±æ€§æ”¶çª„çŠ¶æ€ï¼Œæ¶ˆç­ isLoading å’Œ data æ··ç”¨çš„æƒ…å†µ' },
            { line: 19, text: '// ğŸ’¡ å®‰å…¨çš„ Payload è§£æ„' },
        ],
    },
    {
        id: 'fe-1-task', type: 'frontend',
        title: 'å®æˆ˜ï¼šSaaS çº§å¼ºç±»å‹ Button',
        category: 'æ¨¡å—1ï¼šç°ä»£åŸºç¡€æ¶æ„ä¸æƒé™', track: 'å‰ç«¯æ¶æ„',
        moduleNumber: 1, lessonNumber: 4, language: 'typescript',
        startingCode: '',
        instructions: `# å¯å‘å¼å®æˆ˜ï¼šå¼€å‘ä¼ä¸šçº§å¼ºç±»å‹ UI ç»„ä»¶åº“

## ğŸ¯ ä¸šåŠ¡ä¸Šä¸‹æ–‡ä¸æˆ‘ä»¬åœ¨åšä»€ä¹ˆï¼Ÿ
åœ¨ä¸€ä¸ªæ•°äººå¼€å‘çš„å¤§å‹ SaaS çœ‹æ¿ä¸­ï¼Œä¼šæœ‰æ•°ç™¾ä¸ªæŒ‰é’®ã€‚å¦‚æœå¤§å®¶æ¯æ¬¡éƒ½åœ¨ä»£ç é‡Œæ‰‹å†™åˆé•¿åˆç¹ççš„ Tailwind ç±»åï¼Œä¸ä½†æå¤§é˜»ç¢å¼€å‘æ•ˆç‡ï¼Œè€Œä¸”åœ¨ä¿®æ”¹ç³»ç»Ÿä¸»è‰²è°ƒæ—¶é¢ä¸´æ— ä»é‡æ„çš„å™©æ¢¦ã€‚
åœ¨è¿™é‡Œï¼Œæˆ‘ä»¬éœ€è¦å‰¥ç¦»æ ·å¼ï¼Œåˆ¶ä½œä¸€ä¸ªèƒ½å¤Ÿ**æä¾›è¯­æ³•æ™ºèƒ½æç¤º**çš„åŸºç¡€ UI ç»„ä»¶ã€‚ä½ çš„ä½¿ç”¨ä½“éªŒåº”è¯¥æ˜¯åƒç§¯æœ¨ä¸€æ ·ï¼š\`<Button variant="danger" size="lg">åˆ é™¤æ•°æ®</Button>\`ã€‚å¦‚æœæ–°æ¥çš„å®ä¹ ç”Ÿæ‹¼é”™äº†å˜ä¸º \`variant="red"\`ï¼Œå®ƒè¿ç¼–è¯‘æœŸéƒ½è¿‡ä¸å»ï¼è¿™å«é€šè¿‡å¼ºçº¦æŸæå‡å›¢é˜Ÿçš„è¾¹ç•Œè´¨é‡ã€‚

## ğŸ” ä»£ç æ·±åº¦è§£æ
- **å­—é¢é‡è”åˆç±»å‹ï¼ˆLiteral Union Typesï¼‰**ï¼šæ¯”å¦‚ \`'sm' | 'md' | 'lg'\`ã€‚è¿™è¦æ±‚ä½ åœ¨ä¼ å…¥å€¼æ—¶å®ƒå¿…é¡»æ˜¯è¿™ç»„æœ‰é™é›†ä¸­çš„å­—ç¬¦ä¸²ï¼Œè€Œä¸èƒ½æ˜¯éšæ„çš„ \`'super-big'\`ã€‚
- **\`ButtonProps extends ...\`**ï¼šç»„ä»¶ç»ä¸èƒ½ä»…ä»…åªæœ‰ä½ ä¼ å…¥çš„é‚£å‡ ä¸ªå±æ€§ã€‚å¦‚æœç”¨æˆ·æƒ³åœ¨è¿™ä¸ª Button ä¸ŠæŒ‚è½½ä¸€äº›æ— éšœç¢å±æ€§ \`aria-hidden\` æˆ–è€…æå…¶å¸¸ç”¨çš„ \`disabled\`ï¼Œå¦‚æœåœ¨å†™ä»£ç æ—¶ä½ ä¸€ä¸ªä¸€ä¸ªé…å°±æ— ç©·æ— å°½äº†ã€‚æ‰€ä»¥æˆ‘ä»¬éœ€è¦ç›´æ¥ä½¿ç”¨ TS çš„ç»§æ‰¿ç³»ç»Ÿï¼ŒåŸå°ä¸åŠ¨åœ°å°†æ‰€æœ‰ \`button\` æ ‡ç­¾åº”æœ‰çš„èƒ½åŠ›åŒ…è£¹è¿›å»ã€‚
- **\`Record<K, V>\` å­—å…¸æ˜ å°„**ï¼šå®ƒæ˜¯ä¸€ç§æå…¶å¼ºçƒˆçš„è¡¨å•æŸ¥é˜…è¡¨ç»“æ„ã€‚å½“å·¦è¾¹å£°æ˜äº†æ¶µç›–æ‰€æœ‰å±æ€§çš„ \`K\`ï¼Œå¦‚æœå†™æ˜ å°„æ—¶ä½ æ¼æ‰äº†å…¶ä¸­æŸä¸€é¡¹ï¼ˆæ¯”å¦‚å¿˜äº†å†™ mdï¼‰ï¼Œç¼–è¯‘å™¨å½“å³é˜»æ­¢æäº¤ã€‚è¿™æ¶ˆç­äº†ä¸Šçº¿åå‘ç°æŸç±»æ ·å¼è£¸å¥”ç¼ºå¤±çš„é‡å¤§ç”Ÿäº§äº‹æ•…ã€‚
- **\`...rest\` å±æ€§é€ä¼ **ï¼šé…åˆç»§æ‰¿ç³»ç»Ÿï¼ŒæŠŠæˆ‘ä»¬è§£æ„å‰©ä¸‹çš„æœªçŸ¥åå¯¹è±¡å…¨å‘˜ç›´æ¥èµ‹äºˆåº•å±‚çš„ DOM èŠ‚ç‚¹ä¸Šã€‚

### ğŸ§  åº•å±‚åŸç†å‰–æï¼šReact Props ç©¿é€ä¸ CSS èŒƒå¼
**å‰©ä½™å‚æ•°ä¸ Props é€ä¼ è§£æ**ï¼š
å½“ JSX è¢« babel è¿›è¡Œè¯æ³•åˆ†æï¼ˆLexical Analysisï¼‰å’Œè½¬è¯‘ï¼Œ\`<Button disabled {...rest} />\` ä¼šå˜æˆä¸€ä¸ªå·¨å¤§çš„ \`React.createElement\` çš„å…¥å‚å¯¹è±¡ï¼š\`{"disabled":true, ...rest}\`ã€‚å½“ç»„ä»¶æ¸²æŸ“è¯¥åº•å±‚ \`button\` å…ƒç´ ï¼ŒReact ä¼šé€šè¿‡ä¸€å¥—ä¸¥é…·çš„å±æ€§ç™½åå•å°†åˆæ³•çš„ HTML Attributes æ˜ å°„åˆ°çœŸæ­£çš„ DOM Property ä¸Šï¼Œä»è€Œèµ‹äºˆå®ƒç¦ç”¨å˜ç°çš„ç¥å¥‡æ•ˆæœã€‚

**åŸå­åŒ– CSSï¼ˆTailwindï¼‰å·¥ä½œåŸç†**ï¼š
ä»¥å‰å‰ç«¯çš„ç»„ä»¶åº“ç”¨çš„æ˜¯ BEM è§„èŒƒæˆ–è€… CSS-in-JSã€‚å½“æˆ‘ä»¬åœ¨è¿™æ‹¼å‡‘å‡ºäº† \`class="px-3 py-2 bg-blue-500 rounded"\` æ—¶ï¼Œä¸ºä»€ä¹ˆè¿™äº›æ ·å¼æ–‡ä»¶ä¸ä»…ä¸å¡ï¼Œè¿˜èƒ½åœ¨ç”Ÿäº§ç¯å¢ƒæå°ï¼Ÿ
Vite åœ¨æ‰“åŒ…æŒ‚è½½ Tailwind å¼•æ“æ—¶ï¼Œä¼šåœ¨æ•´ä¸ªé¡¹ç›®è¿›è¡Œä¸€æ¬¡æ­£åˆ™æ‰«æã€‚å®ƒæ‰«æå‡ºäº†ä½ åœ¨æ‰€æœ‰ TSX æ–‡ä»¶ä¸­æ‰€ç”¨åˆ°çš„ç±»åï¼Œç„¶ååªä»å…¶è‡ªå¸¦çš„æ•°ä¸‡ç±»çš„åºå¤§å›¾é›†ä¸­æå–ä½ å†™äº†çš„è¿™å‡ ä¸ªç±»æ³¨å…¥ç”Ÿäº§ \`styles.css\`ã€‚æ‰€ä»¥ï¼Œ**ç»å¯¹ä¸èƒ½åœ¨è¿™é‡Œè¿›è¡Œå­—ç¬¦ä¸²æ‹¼æ¥å¼çš„åŠ¨æ€ç±»åï¼ˆå¦‚ \`bg-\${color}-500\`ï¼‰**ï¼Œè¿™ä¼šå¯¼è‡´æ‰«æå™¨æ‰¾ä¸åˆ°å®Œæ•´çš„è¯æ ¹è€Œè¿‡æ»¤æ‰è¯¥å¤®è¡Œçš„ CSSã€‚æ­¤æ–¹æ¡ˆä½¿ç”¨ Record çš„å®Œå…¨æ˜¾å¼çš„æ˜ å°„æ‰æ˜¯æ­£é“ã€‚`,
        targetCode: `import React from 'react';\n\n// ğŸ’¡ åªæœ‰è¿™ä¸‰ç§å˜ä½“æ˜¯è¢«å…è®¸çš„ï¼Œå…¶ä»–æ‹¼å†™é”™è¯¯åœ¨ç¼–ç é˜¶æ®µå°±ä¼šå‘Šè­¦\ntype ButtonVariant = 'primary' | 'secondary' | 'danger';\ntype ButtonSize = 'sm' | 'md' | 'lg';\n\n// ğŸ’¡ ç»§æ‰¿åŸç”Ÿ button çš„æ‰€æœ‰å±æ€§ï¼ˆæ¯”å¦‚ type, disabledï¼‰ï¼Œæ— éœ€é‡å¤å£°æ˜\ninterface ButtonProps extends React.ButtonHTMLAttributes<HTMLButtonElement> {\n  variant: ButtonVariant;\n  size: ButtonSize;\n}\n\n// ğŸ’¡ ä½¿ç”¨ Record<K, V> æ˜ å°„ï¼Œç¡®ä¿ä½ ä¸ºæ¯ä¸€ç§å˜ä½“éƒ½æä¾›äº†ç›¸åº”çš„ CSS ç±»\nconst sizeClasses: Record<ButtonSize, string> = {\n  sm: 'px-3 py-1.5 text-sm',\n  md: 'px-4 py-2 text-base',\n  lg: 'px-6 py-3 text-lg',\n};\n\nconst variantClasses: Record<ButtonVariant, string> = {\n  primary: 'bg-[#4285F4] text-white hover:bg-blue-700',\n  secondary: 'bg-gray-100 text-gray-700 hover:bg-gray-200',\n  danger: 'bg-red-600 text-white hover:bg-red-700',\n};\n\nexport function Button({ variant, size, children, className, ...rest }: ButtonProps) {\n  return (\n    <button\n      // ğŸ’¡ è§£æ„åŸç”Ÿå±æ€§å¹¶æ‹¼æ¥æ ¸å¿ƒæ ·å¼\n      className={\`font-medium transition-colors rounded-lg \${sizeClasses[size]} \${variantClasses[variant]} \${className || ''}\`}\n      {...rest}\n    >\n      {children}\n    </button>\n  );\n}\n`,
        comments: [
            { line: 3, text: '// ğŸ’¡ åœ¨å¼€å‘IDEä¸­èƒ½è·å¾—è‡ªåŠ¨æç¤º' },
            { line: 7, text: '// ğŸ’¡ extends ç»§æ‰¿æ˜¯æ„å»ºåŸºç¡€ç»„ä»¶çš„æœ€ä½³å®è·µ' },
            { line: 13, text: '// ğŸ’¡ Record: å¦‚æœä½ æ¼å†™äº† smï¼Œè¿™è¡Œå°±ä¼šæŠ¥é”™ï¼Œé˜²æ­¢ä¸Šçº¿ç¼ºæ ·å¼' },
            { line: 28, text: '// ğŸ’¡ å°†ä½™ä¸‹çš„å¦‚ onClick äº‹ä»¶ç›´æ¥é€ä¼ ç»™åº•å±‚ DOM' },
        ],
    },
    {
        id: 'fe-2-1', type: 'frontend',
        title: 'è¯¾ç¨‹ 2.1ï¼šä¼˜åŒ–çŸ­è§†é¢‘ Feed æµå¡ç‰‡',
        category: 'æ¨¡å—2ï¼šç»„ä»¶æ¶æ„ä¸è§†é¢‘æµ', track: 'å‰ç«¯æ¶æ„',
        moduleNumber: 2, lessonNumber: 1, language: 'typescript',
        startingCode: '',
        instructions: `# ä¿æŠ¤æµ·é‡èŠ‚ç‚¹çš„ä¼˜åŒ–ï¼šReact.memo

## ğŸ¯ ä¸šåŠ¡ä¸Šä¸‹æ–‡ä¸æˆ‘ä»¬åœ¨åšä»€ä¹ˆï¼Ÿ
åœ¨ä¸€ä¸ªåºå¤§çš„æµå¼çŸ­è§†é¢‘ä¿¡æ¯æ¿ä¸­ï¼Œå½“åå°é€šè¿‡é«˜å°„ç‚®èˆ¬çš„é€Ÿåº¦ä¼ å›æ•°åƒæ¡ JSON æ•°æ®æ—¶ï¼Œæµè§ˆå™¨å†…å­˜é‡Œçš„æ ‘ç»“æ„æå…¶åºå¤§ã€‚
å¦‚æœç”¨æˆ·è¿™ä¸ªæ—¶å€™ç‚¹å‡»äº†ç•Œé¢å³ä¸Šè§’éå¸¸ä¸ç›¸å…³çš„åŠŸèƒ½â€”â€”â€œå¼€å¯/å…³é—­é»‘æš—æ¨¡å¼â€ï¼Œæ•´ä¸ªæ ¹çº§çš„çŠ¶æ€å‘ç”Ÿäº†æ”¹å˜ã€‚React åœ¨é¢ä¸´è¿™ç§é«˜é¢‘æ·±è¿œçš„çŠ¶æ€æ ‘å˜åŒ–æ—¶ï¼Œæœ‰ç€ä¸€ä¸ªé»˜è®¤çš„è‡´å‘½ç¼ºé™·ï¼šå®ƒä¼šè‡ªåŠ¨è§¦å‘è‡ªå…¶åŠå…¶æ‰€æœ‰æˆç™¾ä¸Šåƒä¸ªå­—ç»„ä»¶åä»£ä»¬çš„é€’å½’é‡æ–°æ¸²æŸ“ã€‚å°½ç®¡ç”±äºè™šæ‹Ÿ DOM ä¸ä¼šæ³¢åŠç‰©ç† DOM å±‚é¢ï¼Œä½†è¿™ä¸‡æ¬¡æ— æ•ˆé‡é‡éå†å·²ç»è¶³ä»¥è®©ä½ çš„æµè§ˆå™¨æ‰å¸§å¡æ­»ã€‚

## ğŸ” ä»£ç æ·±åº¦è§£æ
- **\`React.memo\`**ï¼šè¿™å±‚åä¸ºå¤‡å¿˜å½•ï¼ˆmemoizeï¼‰çš„æŠ¤ç›¾ï¼Œå¥—åœ¨æš´éœ²å‡ºå»çš„å‡½æ•°ç»„ä»¶ä¸Šã€‚å¦‚åŒæµ·å…³çš„æŠ¤ç…§è¯†åˆ«å™¨ã€‚
- **æµ…æ¯”è¾ƒæ‹¦æˆª**ï¼šæ¯æ¬¡éœ€è¦é‡æ¸²æŸ“å‰ï¼ŒReact æˆªä½äº†ç»„ä»¶ã€‚å®ƒä¼šç”¨ \`Object.is\` åˆ†åˆ«æ ¸å¯¹ä¸Šä¸€åˆ»å’Œè¿™ä¸€åˆ»ä¼ å…¥çš„ \`{ video, onLike }\` é‡Œçš„å±æ€§åœ°å€æœ‰æ²¡æœ‰å˜åŠ¨ã€‚å¦‚æœæ²¡æœ‰ï¼ŒReact æ–­å®šæ²¡å¿…è¦æ·±å…¥æŸ¥æ¢ï¼Œç›´æ¥ä½¿ç”¨å†…å­˜é‡Œè¿˜çƒ­åœ¨å¿«å–å±‚çš„æ—§ Virtual DOMï¼Œå¹¶ä¸­æ­¢æ¥åŠ›çš„æ¸²æŸ“æµå‘ä¸‹ä¼ æ’­ã€‚
- **çŠ¶æ€æå‡ \`onLike\`**ï¼šè¿™æ˜¯ä¸€ä¸ªéå¸¸å…³é”®çš„æŠ€å·§ï¼ˆLifting State Upï¼‰ã€‚å¡ç‰‡éå¸¸â€œè ¢â€ï¼Œå®ƒä¸è´Ÿè´£ä¸åç«¯é€šè®¯ï¼Œå®ƒåªå‘å‡ºè‡ªå·±çš„ä¸€ä¸ªä¿¡å·ï¼›è¿™èƒ½ä½¿å¾—ç»„ä»¶ç‹¬ç«‹å¹¶å¯ä»¥é«˜åº¦å¤ç”¨åœ¨å…¶ä»–ä»»ä½•ä¸åŒ…å«ç‚¹èµä½†æ˜¯å¤–è¡¨ä¸€æŠ¹ä¸€æ ·çš„åˆ—è¡¨é¡µé¢ä¸­ã€‚

### ğŸ§  åº•å±‚åŸç†å‰–æï¼šVirtual DOM é‡æ„ä¸ Memoization åŸåˆ™æ˜¯æ€æ ·çš„
**ä» Diff ç®—æ³•åˆ°ç‰©ç† DOM é‡ç»˜æœºåˆ¶ï¼š**
React ä¸æ˜¯ä»€ä¹ˆé­”æ³•ï¼Œå®ƒèƒŒåä¾ç„¶æ˜¯é‚£å‡ è¡Œè¢« C++ ç¼–æˆæœºå™¨ç åœ¨ Chrome çš„ Blink å¼•æ“è·‘å‡ºçš„ \`document.createElement\`ã€‚
å½“ç³»ç»ŸçŠ¶æ€å˜åŠ¨æ—¶ï¼ŒReact æ‰§è¡Œ render()ï¼ˆä¹Ÿå°±æ˜¯å†è°ƒç”¨ä¸€éä½ æ‰‹å†™çš„ç»„ä»¶é‚£ä¸ªé•¿é•¿çš„å‡½æ•°ï¼‰ã€‚äº§ç”Ÿå‡ºä¸€æ£µå…¨æ–°çš„ JS å¯¹è±¡æ ‘ï¼ˆä¹Ÿå°±æ˜¯å¸¸è¯´çš„ Virtual DOMï¼‰ã€‚
æ­¤æ—¶è°ƒå’Œå™¨ (Reconciler) å°†è€æ ‘ä¸æ–°æ ‘è¿›è¡Œä¸¤å±‚æ ‘çº§åˆ«æ¯”å¯¹è¿™è¢«æˆä¸º **Diffingï¼ˆæ±‚å¼‚ç®—æ³•ï¼‰**ã€‚è¿™ç§æ“ä½œçœ‹ä¼¼æ˜‚è´µä½†å®ƒå› ä¸ºä¸è§¦åŠçœŸå® HTMLï¼Œå› æ­¤èƒ½æ‰¿å—æµ·é‡ O(N) ä»¥å†…çš„æ ‘é€’å½’ã€‚å½“ Diff å¾—åˆ°å˜æ›´æ¸…å• (Patches) æ—¶ï¼Œæ‰é€šè¿‡åº•å±‚ç»‘å®šæ‰¹é‡æ³¨å…¥ç‰©ç† DOMï¼Œå¼•å‘ GPU å‚ä¸çš„ \`Repaintï¼ˆé‡ç»˜ï¼‰\` ä¸ \`Reflowï¼ˆå›æµä½ç½®é‡æ‹ï¼‰\`ã€‚
ä½¿ç”¨ \`React.memo\` æ˜¯æä¸ºé«˜æ˜çš„â€œæ—©é€€â€æ€æƒ³ï¼šä¸€æ—¦æµ…æŒ‡é’ˆæ¯”è¾ƒåˆ¤æ–­ä¸€æ ·ï¼Œè¿ç»„ä»¶å‡½æ•°è¿™ä¸ªé€»è¾‘ä»£ç æ ¹æœ¬éƒ½ä¸æ‰§è¡Œï¼Œç”šè‡³å°†æå…¶è€— CPU å‘¨æœŸçš„ Diffing è·å–æ–°æ—§è€æ ‘è¿™ä¸ªæ ¹æºææ‰ã€‚æ­¤é˜²æŠ¤ä¸ºæ„å»ºé«˜å¯†åº¦æµåª’ä½“åº”ç”¨çš„å‰æã€‚

**æ³¨æ„å‘ç‚¹ï¼š** å¦‚æœä½ çˆ¶ç»„ä»¶ä¸­æ˜¯é€šè¿‡å†…è”å¦‚ \`onLike={() => ... }\` çš„æ–¹å¼æŠ›ç»™ memo ç»„ä»¶çš„ï¼Œå› ä¸ºæ¯æ¬¡çˆ¶çº§é‡ç»˜éƒ½ä¼šé‡æ–°ç”Ÿæˆä¸€æ¬¡å†…å­˜å¤„äºæ–°ä½ç½®çš„å‡½æ•°å¯¹è±¡åœ°å€ï¼Œå®ƒå°†ç›´æ¥æ‘§æ¯ä½ æ‰€æœ‰çš„ memo åˆ¤æ–­å±éšœé€ æˆä¼˜åŒ–å¤±çµï¼ˆåæ–‡æ¨¡å—ä¸­çš„ \`useCallback\` ä¸“æ²»æ­¤ç—…ï¼‰ã€‚`,
        targetCode: `import React from 'react';\n\ninterface Video {\n  id: string;\n  title: string;\n  author: string;\n  views: number;\n  thumbnail: string;\n}\n\ninterface VideoCardProps {\n  video: Video;\n  onLike: (id: string) => void;\n}\n\n// ğŸ’¡ React.memo å‘Šè¯‰å¼•æ“ï¼šå¦‚æœä¼ è¿›æ¥çš„ video å’Œ onLike çš„å†…å­˜æŒ‡é’ˆæ²¡æœ‰å˜ï¼Œå°±ä¸è¦é‡åˆ·æˆ‘çš„è€ DOM\nexport const VideoCard = React.memo(function VideoCard({ video, onLike }: VideoCardProps) {\n  // ğŸ’¡ æ¨¡æ‹Ÿä¸€ä¸‹æ˜‚è´µçš„æ¸²æŸ“é€»è¾‘å¼€é”€\n  console.log('Rendering VideoCard:', video.id);\n\n  return (\n    <div className="flex flex-col rounded-xl overflow-hidden bg-white shadow-sm hover:shadow-md transition-shadow">\n      <img src={video.thumbnail} alt={video.title} className="h-48 w-full object-cover" loading="lazy" />\n      <div className="p-4">\n        <h3 className="font-bold text-gray-800 line-clamp-2">{video.title}</h3>\n        <div className="mt-2 flex justify-between items-center text-sm text-gray-500">\n          <span>@{video.author}</span>\n          <span>{(video.views / 1000).toFixed(1)}K views</span>\n        </div>\n        <button \n          // ğŸ’¡ ç‚¹å‡»å‘ä¸Šä¼ é€’äº‹ä»¶ï¼Œäº¤ç”±çˆ¶ç»„ä»¶è°ƒç”¨åç«¯API\n          onClick={() => onLike(video.id)}\n          className="mt-4 w-full py-2 bg-[#E8F0FE] text-[#1967D2] font-medium rounded-lg hover:bg-blue-100"\n        >\n          ç‚¹èµæ”¯æŒ\n        </button>\n      </div>\n    </div>\n  );\n});\n`,
        comments: [
            { line: 15, text: '// ğŸ’¡ React.memo æ‹¦æˆªä¸å¿…è¦çš„ Diff æ¯”å¯¹' },
            { line: 22, text: '// ğŸ’¡ loading="lazy": éå¸¸é‡è¦çš„æ€§èƒ½ä¼˜åŒ–ï¼Œä¸å è§†å£ä¸åŠ è½½å›¾' },
            { line: 30, text: '// ğŸ’¡ Lifting State Up: è®©ä¸šåŠ¡é€»è¾‘æ§åˆ¶æƒç•™åœ¨çˆ¶å±‚' },
        ],
    },
    {
        id: 'fe-2-2', type: 'frontend',
        title: 'è¯¾ç¨‹ 2.2ï¼šæ„å»ºæ— é™æ»šåŠ¨ Hook',
        category: 'æ¨¡å—2ï¼šç»„ä»¶æ¶æ„ä¸è§†é¢‘æµ', track: 'å‰ç«¯æ¶æ„',
        moduleNumber: 2, lessonNumber: 2, language: 'typescript',
        startingCode: '',
        instructions: `# æ„å»ºåŸç”Ÿäº¤äº’é˜²é—­åŒ…ç¼ºé™·çš„æ— é™æ»šåŠ¨ Hook

## ğŸ¯ ä¸šåŠ¡ä¸Šä¸‹æ–‡ä¸æˆ‘ä»¬åœ¨åšä»€ä¹ˆï¼Ÿ
åƒå°çº¢ä¹¦ã€æŠ–éŸ³ï¼ˆTiktokï¼‰æˆ–æ˜¯ä»Šæ—¥å¤´æ¡é‚£æ ·æé«˜ä¸Šç˜¾æ€§çš„å†…å®¹ç€‘å¸ƒç½‘ç»œï¼Œå®ƒçš„ç»ˆæäº¤äº’å½¢æ€ä¸€å®šæœ‰ä¸”åªèƒ½æœ‰**æ— é™ç€‘å¸ƒæ»šåŠ¨åŠ è½½**ã€‚è¿™æœ¬è´¨æ˜¯åœ¨åˆ—è¡¨åº•éƒ¨åŸ‹è®¾ä¸€ä¸ªç©ºçš„é¢„è­¦èŠ‚ç‚¹ã€‚ä½†æ˜¯å¦‚æœæˆ‘ä»¬åœ¨è¿™ä¸ªé¡µé¢é‡Œç›´æ¥æ‰‹å†™åŸç”Ÿçš„ç›‘å¬ä»£ç å°±ä¼šè®©é€»è¾‘å½»åº•è…çƒ‚ï¼Œå› ä¸ºè¿™ä¸ªé¡¹ç›®é‡Œå°†ä¼šæœ‰æ•°ä¸èƒœæ•°çš„éœ€è¦ç€‘å¸ƒæ»šåŠ¨çš„å­é¡µé¢ã€‚
æˆ‘ä»¬å°†ä¸šåŠ¡ä¸­è·å–ç½‘ç»œèµ„æºçš„è¿‡ç¨‹è¿›è¡Œå°è£…ï¼Œæš´éœ²ä¸ºä¸€ä¸ªæå…¶è¿·ä½ çš„è‡ªç ” Custom Hook \`useIntersectionObserver\`ã€‚è¿™ä¹Ÿæ˜¯æ„å»ºä½ è‡ªå·±åºå¤§å‰ç«¯ç»„ä»¶åº•å±‚çš„åŸºç¡€ç´ å…»ã€‚

## ğŸ” ä»£ç æ·±åº¦è§£æ
- **\`useRef(callback)\` çš„ç»å¦™ä½¿ç”¨**ï¼šåˆå­¦è€…ä¸€å®šä¼šè¸©ä¸­çš„æƒŠå¤©å·¨å‘ï¼šå½“ä½ å¾€æŸä¸ªå¼‚æ­¥çš„å›è°ƒæ± ï¼ˆå¦‚ \`setInterval\` æˆ–ç¬¬ä¸‰æ–¹å¯¹è±¡ \`Observer\` é‡Œï¼‰ç”Ÿæ‰”ä¸€ä¸ªç”±äºåŒ…å« \`useState\` ä¼šä¸æ–­é‡æ–°æ¸²æŸ“æ‰€å¼•ç”¨çš„é—­åŒ…å›è°ƒæ—¶ï¼Œé‚£ä¸ªè§¦å‘å›è°ƒé‡Œé¢å¯¹è¯¸å¦‚ \`page\` çš„æ“ä½œæ°¸è¿œåªä¿ç•™ç€å®ƒå‡ºä¸–é‚£ç¬¬ä¸€éçš„å¯æ‚²çŠ¶æ€ï¼Œä¾‹å¦‚æ°¸è¿œå¡æ­»æ‰“å°å‡º \`page = 1\`ã€‚æˆ‘ä»¬è¿™é‡Œçš„ä»£ç å·§å¦™åˆ©ç”¨ä¸€ä¸ªä¸éšç€é‡æ–°æ¸²æŸ“è¢«é‡ç½®æˆ–å¼•å‘ç”Ÿç”Ÿä¸æ¯çš„â€œé™æ€å®¹å™¨â€ï¼ˆRefï¼‰ä¿ç•™ä½äº†æœ€æ–°æ›´æ–°çš„é‚£ç‰ˆçš„æœ€æ–°åŠ¨ä½œæŒ‡é’ˆã€‚è¿™å¯è°“æ˜¯å¯¹æŠ—é—­åŒ…çš„å¤§æ‰‹ç¬”ã€‚
- **\`IntersectionObserver\`**ï¼šè¿™æ˜¯æµè§ˆå™¨æå…·é©å‘½æ€§çš„ä¸€ä¸ªè¶…æ–°åŸç”Ÿ API æ“ä½œç±»ã€‚å®ƒä¸“é—¨ä¸ºäº†æ›¿ä»£é‚£äº›æ˜‚è´µä¸”æ„šè ¢çš„ \`window.addEventListener("scroll", èŠ‚æµä»£ç )\` äº§ç”Ÿã€‚å½“ç»‘å®šçš„ç‰©ä½“ä¸è§†å£è¿›è¡Œå‡ ä½•è£å‰ªé¢ç¢°æ’å‘ç”Ÿæ¥è§¦æ—¶ï¼ˆIntersectingï¼‰ï¼Œåº•å±‚æŠ›å‡ºäº‹ä»¶ã€‚
- **\`observer.disconnect()\`**ï¼šè¿™æ˜¯ç”Ÿå‘½å‘¨æœŸçš„æœ«ç«¯æœºåˆ¶ï¼Œç»„ä»¶ä¸‹æ¶å¦‚æœç›‘å¬ä¸ç§»é™¤ä¼šå¯¼è‡´å¼ºå¼•ç”¨ä»è€Œè¯±å‘æƒŠå¤©çš„å†…å­˜é—æ¼çº§éšæ‚£ã€‚

### ğŸ§  åº•å±‚åŸç†å‰–æï¼šReact é—­åŒ…é™·é˜±çš„æ•°å­¦ç¼˜ç”±ä¸ Ref æœºåˆ¶
**é—­åŒ…ä¸çŠ¶æ€å¿«ç…§ï¼ˆStale Closuresï¼‰çš„ææ€–åœ°å¸¦**ï¼š
åœ¨ JavaScript ä½“ç³»ä¸‹ï¼Œç”±äº React Functional Component æœ¬è´¨ä¸Šæ˜¯ä¸€éåˆä¸€éåå¤é‡æ–°è¿›å…¥å†è„±å‡ºçš„å‡½æ•°ã€‚å½“ç¬¬ä¸€æ¬¡æŒ‚è½½ç»„ä»¶ï¼Œå†…éƒ¨ä¼šæ„å»ºå‡ºä¸€ä¸ªæ‹¥æœ‰æœ€åˆç”Ÿå‘½å€¼åŸŸ \`page = 1\` çš„é‚£ä¸ªå†…å­˜ç¯å¢ƒé‡Œçš„é—­åŒ…å‡½æ•°å« \`A\`ã€‚
\nå½“ä½ æŠŠ \`A\` ä½œä¸ºå§”æ‰˜ä¼ ç»™å¤–æŒ‚å¯¹è±¡ \`Observer\` å¹¶åœ¨å®ƒçš„å¯¹è±¡æ ‘ä¸Šæ°¸ç”Ÿç›‘å¬ç€ï¼Œä¹‹åç”±äºæŸäº›å…¶ä»–äº‹æƒ… React ç»„ä»¶è¿›å…¥äº†ç¬¬ä¸‰æ¬¡ä»å¤´éå†å‡½æ•°ï¼Œæ„å»ºå‡ºçš„åŒ…å«äº† \`page = 3\` ç¯å¢ƒçš„é—­åŒ…å« \`C\`ï¼Œç”±äºä½ ä¾èµ–å…³ç³»æ•°ç»„é‡Œæ²¡æœ‰æŠŠç”±äº \`useIntersectionObserver\` å°å­˜æ‰€é€ æˆçš„æ·±åº¦åˆ†ç¦»è¿æ¥æ›´æ–°ï¼Œé‚£ä¹ˆå‘ç”Ÿåˆ°è¾¾åº•éƒ¨äº‹ä»¶æ—¶ï¼Œæ‰§è¡Œçš„ä»ç„¶æ˜¯æœ€åˆçš„ \`A\` â€”â€” è¿™æ˜¯å¯¼è‡´é€»è¾‘æ··ä¹±æ— ç«¯è§¦å‘é”™è¯¯çš„æ ¹æºã€‚

**\`useRef\`ï¼ˆç›’å­ï¼‰ä¸ºä»€ä¹ˆå¯ä»¥è§£å†³é—®é¢˜ï¼Ÿ**
\`useRef\` æ„å»ºçš„æ•°æ®å­˜å‚¨å®ƒå¹¶ä¸å¤„åœ¨æ­¤ç»„ä»¶è¿™å±‚ç©ºé—´é‡Œã€‚å®ƒæ˜¯è¢«å®‰ç½®åˆ° React æ§åˆ¶çš„æœ€åº•å±‚çš„ç”± Fiber ç®¡ç†çš„é‚£ä¸ªè¢«æŒä¹…é©»æ‰åœ¨å †é‡Œçš„å›ºå®šå†…å­˜ä½ç½®ä¸Šï¼ˆå³ç›’å­çš„æœ¬è´¨æ˜¯ä¸€ä¸ªæ°¸è¿œä¸æ¢ç‰©ç†é—¨ç‰Œçš„ Mutable å¯¹è±¡ \`{ current: ... }\`ï¼‰ã€‚
å½“å¤–æŒ‚ \`Observer\` è¿›è¡Œè°ƒç”¨æ—¶ï¼Œä»–å¹¶ä¸ç›´æ¥è°ƒæŸä¸ªç‰ˆæœ¬çš„é—­åŒ…å®ä½“ \`A\`ã€‚å®ƒæ‰¾åˆ° \`box\` è¿™ä¸ªæ°¸è¿œå®šæ ¼ä½ç½®çš„å¤–å£³ï¼Œç„¶åå†å¾€é‡Œè¾¹ä¸€çœ‹ â€”â€” \`{ current: æœ€æ–°ç”Ÿæˆçš„ C }\`ã€‚è‡³æ­¤åœ¨æ¯ä¸€æ¬¡ Render å®ƒéƒ½ä¼šå®æ—¶é€šè¿‡ \`callbackRef.current = callback\` ç”¨æœ€æœ€å´­æ–°çš„å†…å®¹æŠŠè€å†…å®¹åœ¨æ·±å¤„æŒ¤å‹å¡«æ²¡æ›¿æ¢ï¼Œä¿è¯å¼•ç”¨æŒ‡é’ˆå¦‚é’¢ä¸ç»³èˆ¬ä¸æ‰åŒ…ã€‚å·§å¦™åŒ–è§£è¿™ä¸ªæ­»æ‰£é—®é¢˜ã€‚`,
        targetCode: `import { useEffect, useRef } from 'react';\n\n// ğŸ’¡ è¿™ä¸ª Hook çš„ä½œç”¨æ˜¯ï¼šå½“ä½ ç»™å®ƒçš„å…ƒç´ éœ²è„¸ï¼ˆç›¸äº¤ï¼‰æ—¶ï¼Œå®ƒå°±æ‰§è¡Œä½ çš„ callbackã€‚\nexport function useIntersectionObserver(\n  callback: () => void,\n  options?: IntersectionObserverInit\n) {\n  const targetRef = useRef<HTMLDivElement>(null);\n  \n  // ğŸ’¡ useRef(callback) - [ç ´è§£é—­åŒ…é™·é˜±çš„æ ¸å¿ƒ] \n  // ç”±äº callback åœ¨çˆ¶ç»„ä»¶å†…å¯èƒ½ä¼šé¢‘ç¹é‡ç°ï¼ˆæ¯”å¦‚å¸¦æœ‰ page çŠ¶æ€ï¼‰ï¼Œ\n  // è¿™ä¸ª ref ä¼šä¿è¯ observer.observe å†…è§¦å‘çš„å§‹ç»ˆæ˜¯æœ€æ–°çš„é€»è¾‘å¼•ç”¨ã€‚\n  const callbackRef = useRef(callback);\n  \n  useEffect(() => {\n    callbackRef.current = callback;\n  }, [callback]);\n\n  useEffect(() => {\n    const target = targetRef.current;\n    if (!target) return;\n\n    const observer = new IntersectionObserver(([entry]) => {\n      // ğŸ’¡ åœ¨äº¤å‰ä¸”å›è°ƒå­˜åœ¨æ—¶æ‰§è¡ŒåŠ¨ä½œ\n      if (entry.isIntersecting) {\n        callbackRef.current();\n      }\n    }, { threshold: 0.1, ...options });\n\n    observer.observe(target);\n    // ğŸ’¡ è®°å¾—æ¸…ç†ç›‘å¬å™¨\n    return () => observer.disconnect();\n  }, [options]);\n\n  return targetRef;\n}\n`,
        comments: [
            { line: 3, text: '// ğŸ’¡ å°è£… DOM Observer ä½¿å¾—ä¸šåŠ¡å±‚åªå…³å¿ƒ "éœ²è„¸äº†è¯¥å¹²å˜›"' },
            { line: 10, text: '// ğŸ’¡ æŒä¹…åŒ–å­˜æ”¾æœ€æ–°çš„ callback å‡½æ•°ä½“' },
            { line: 24, text: '// ğŸ’¡ entry.isIntersecting åˆ¤æ–­æ˜¯å¦ä»åº•ä¸‹å·ä¸Šæ¥äº†' },
        ],
    },
    {
        id: 'fe-2-3', type: 'frontend',
        title: 'è¯¾ç¨‹ 2.3ï¼šä½¿ç”¨ Web Worker å¸è½½æ’åºè®¡ç®—',
        category: 'æ¨¡å—2ï¼šç»„ä»¶æ¶æ„ä¸è§†é¢‘æµ', track: 'å‰ç«¯æ¶æ„',
        moduleNumber: 2, lessonNumber: 3, language: 'typescript',
        startingCode: '',
        instructions: `# å‹è½´ï¼šå¸è½½é‡ç®—åŠ›ä¸‹æ³¨ Web Worker çš„å¹¶å‘

## ğŸ¯ ä¸šåŠ¡ä¸Šä¸‹æ–‡ä¸æˆ‘ä»¬åœ¨åšä»€ä¹ˆï¼Ÿ
åœ¨æ•°æ®çœ‹æ¿åº”ç”¨ä¸­å¦‚æœæœ‰ä¸€ç™¾ä¸‡è¡Œçš„ç›‘æ§ä¿¡æ¯è¢«æ”¾åœ¨äº†å‰å°å±•ç°å¤§å±ä¸­ã€‚å¦‚æœç”¨æˆ·ç°åœ¨å› ä¸ºæŸäº›åå¥½ï¼Œè½»ç‚¹äº†æŒ‰â€œæ—¶é—´â€è¿›è¡Œé‡æ–°æ’åºï¼ˆæˆ–èšåˆæœç´¢ï¼‰ã€‚å¦‚æœè¿™ç›´æ¥äº¤ç”±æˆ‘ä»¬ç»„ä»¶æ¥åŸå°ä¸åŠ¨ç®—çš„è¯ï¼ˆå³ \`Array.prototype.sort()\`ï¼‰ï¼Œå®ƒç»å¯¹ä¸æ˜¯åªå‘ç”Ÿç‚¹å¡ç™½çš„é—®é¢˜ã€‚åœ¨è¿™é•¿è¾¾å‡ åç§’è¿ç®—å®Œæˆçš„å‰ä¸€åˆ»ã€‚å› ä¸ºè¿™è€—å¹²äº†å½“å‰æ¸¸åŠ¨ç©ºé—´çš„ä¸»çº¿ç¨‹ï¼Œé‚£ä½¿ç”¨æˆ·ç”±äºææ…Œæƒ³è¿›è¡Œé¡µé¢ç‚¹å‡»å’Œè·³è½¬æ“ä½œé¡µé¢æŒ‰é’®æ ¹æœ¬çº¹ä¸ä¸åŠ¨ã€‚è¿™åœ¨ç”¨æˆ·ä½“éªŒä¸Šæ˜¯æ¯å¤©ç­åœ°çš„ã€‚
è¿™ä¸ä»…æ˜¯ç»„ä»¶çš„æ¶æ„ï¼Œè¿™æ˜¯ç³»ç»Ÿçš„å¿ƒè„è¡€ç®¡å¤§åŠ¨è„‰ï¼šæˆ‘ä»¬å°†åˆ›å»ºå‡ºä¸€åªæ·±æ¸Šåå°é©»åœºçº¿ç¨‹ \`Web Worker\` è¿›è¡Œç®—ç½‘åˆ†ç¦»ã€‚

## ğŸ” ä»£ç æ·±åº¦è§£æ
- **å†…è” Worker è„šæœ¬æ„é€ å— (\`Blob\`)**ï¼šè¦æ‹‰èµ· Workerï¼Œä¼ ç»Ÿåšæ³•æ˜¯éœ€è¦ä¸€ä¸ªç‹¬ç«‹çš„ JS ç‰©ç†æ–‡ä»¶éƒ¨ç½²å‡ºå»ä¾›å…¶æå–å»åŠ è½½ã€‚è¿™ä¸ä»…ç»™é¡¹ç›®é€ æˆå·¨å¤§çš„ä»£ç ç¦»æ•£å½±å“ä¸”ä¼šäº§ç”Ÿæä¸ºéš¾ä»¥å¤„ç†å› ä¸ºè·¯å¾„å¯»æ‰¾ä¸åˆ° 404 çš„åæœã€‚åˆ©ç”¨åˆ›å»ºä¸€ä¸ªè£…æœ‰è¯¥å­—ç¬¦ä¸²é€»è¾‘ç±»å‹çš„çº¯ Blob æ–‡ä»¶å¹¶ç”¨ URL æ˜ å°„è®©å®ƒéª—è¿‡ç¯å¢ƒæ¥å°†ä¸€æ•´ä¸²è„šæœ¬å˜ä¸ºçº¯å‰ç«¯å†…ç”Ÿçš„ç›´æ¥æ‹‰èµ·èƒ½åŠ›ã€‚
- **çº¯å‡€å‡½æ•°çš„ç¯å¢ƒ (\`self\`)**ï¼šè¯·æ³¨æ„å†…éƒ¨æ‰€æœ‰å¼•ç”¨çš„éƒ½æ˜¯é‚£æå…¶å¹²å‡€è€Œå†°å†·çš„åªæœ‰å…¨å±€å˜é‡ \`self\`ã€‚ç”±äºä½ è¿™å—ä¸å…·æœ‰è·å–é‚£ä¸‡åƒ \`dom\` æ“ä½œä¸ç•Œé¢é‡ç½®çš„å¯èƒ½ï¼Œå®ƒæ˜¯ä¸“ä¸ºè¿™ç§éé˜»å¡å¤§é‡è¿ç®—å®šåˆ¶å¼€å‘çš„æå…¶é«˜é€Ÿçš„ç¯å¢ƒã€‚
- **\`useWorkerSort\`**ï¼šç”¨æå…¶ç°ä»£çš„å‰ç«¯é»‘é­”æ³•å’Œ React ç¯å¢ƒå½»åº•æ•´åˆçš„ä¸€å±‚ç»ç¾æŠ½è±¡ã€‚ä½¿ç”¨è€…çš„ä½“éªŒå¦‚åŒè°ƒç”¨åŸç”Ÿå†…ç½®é’©å­é‚£ä¹ˆç®€ç®€å•å•è€Œä¸èˆ¬æŸ”æ¶¦ã€‚åªé€šè¿‡ä¼ ä¿¡æ¯æ¥æ”¶æ›´æ–°ã€‚

### ğŸ§  åº•å±‚åŸç†å‰–æï¼šJS å•çº¿ç¨‹å®¿å‘½ä¸å¹¶å‘æ¨¡å‹
**äº‹ä»¶å¾ªç¯ï¼ˆEvent Loopï¼‰ä¸é˜»å¡ä¸å•çº¿ç¨‹ä¹‹ç—›**ï¼š
Node.js ä»¥åŠ V8 æµè§ˆå™¨å¯¹ JS å®ç°çš„ä¸€ä¸ªéå¸¸åŸºç¡€è€Œç‰¢å›ºçš„æ·é”å°±æ˜¯ä¸»æ ¸å¿ƒæ°¸è¿œåªæœ‰ä¸€ä¸ªï¼ˆå•çº¿ç¨‹ï¼‰ã€‚ä¹Ÿå°±æ˜¯ä¸ç®¡å®ƒæ˜¯åœ¨æ¥å—æ•°æ®ï¼Œå»ä¸‹è½½ï¼ŒæŠ‘æˆ–æ˜¯æ§åˆ¶ DOM é—ªè·³å’Œè§¦å‘æ»‘åŠ¨é‡æ’ï¼šå…¨éƒ½å¿…é¡»ä¸”æ‹¥æŒ¤å»æŠ¢ä½äºé‚£ä¸ªå”¯ä¸€çš„ï¼Œä¸å¯åˆ†å‰²çš„å¾ªç¯éš§é“ï¼ˆè°ƒç”¨æ ˆ Call Stackï¼‰ã€‚
å¦‚æœåœ¨ä¸­é€”åšäº†ä¸€ä¸ªå·¨å‹é•¿è¾¾å‡ å ms çš„æ— æ­¢å°½ \`for\` é€’å½’æ’æŸ¥ã€‚è¿™æ¡éš§é“ç«‹åˆ»è¢«é˜»å¡æ­»äº†ã€‚\`onClick\`ã€\`onMouseOver\` äº‹ä»¶ç­‰å…¨éƒ¨å¡åœ¨åé¢çš„ä»»åŠ¡æ± ä¸­è¿ç€é•¿é•¿çš„é˜Ÿå½¢é™·å…¥å“€åšï¼Œä½¿å¾—æµè§ˆå™¨å‡ºç°äº†å½»åº•ä¸å—äººæœºæ§åˆ¶çš„çŠ¶æ€äº§ç”Ÿï¼ˆæ— å“åº”æˆ–æ­»é”ï¼‰ã€‚

**Actor æ¨¡å‹çš„å­¤å²›åŒé›„ï¼ˆWeb Workerï¼‰**ï¼š
æµè§ˆå™¨ç¯å¢ƒå¹¶ä¸æ˜¯æ— æƒ…åªæœ‰ä¸€é¢—å†…æ ¸ï¼Œå®ƒå¯ä»¥åˆ†ç¦»å¼€ç”Ÿèµ·ä¸€åº§å®Œå…¨ç‹¬ç«‹å¹³è¡Œäºä½ ç½‘é¡µçš„ä¸»è„‘å¹¶ä¸”è·‘åœ¨ä½ çœŸæ­£çš„ç°ä»£å¤šæ ¸å¤„ç†å™¨çš„**æ—ä¾§å¦å¤–æ ¸å¿ƒä¸Š**çš„æœºåˆ¶ã€‚\`Worker\` æ‰§è¡Œçš„ï¼Œå…¶å®æ˜¯ä¼ ç»Ÿå¹¶å‘è®¡ç®—æœºè¯­è¨€ä¸­å¾ˆå¤è€ä¸”è¾‰ç…Œçš„ä¸€ç§æ— é”è§£æ³•å«åš **Actor æ¨¡å‹**ã€‚
è¯¥æ¨¡å‹è§„å®šï¼šè¿™ä¸¤ä¸ªå®‡å®™ï¼Œä»»ä½•äº‹æƒ…ä¸è®ºå®ƒæ˜¯è®¡ç®—å¤šå¤§çš„æµ·é‡æ˜Ÿç³»ï¼Œéƒ½ä¸å¯ä»¥å»ç›´æ¥è¯»æˆ–è€…ä¿®æ”¹å¯¹æ–¹é‡Œé¢çš„å…±äº«çš„æ•°æ®ã€‚è¿™å°±å¤©ç”Ÿè§£å†³äº†å¹¶å‘å†™å…¥æ—¶éœ€è¦åŠ å„ç§å¤æ‚çš„ç«äº‰é”ä»è€Œå¯¼è‡´ç³»ç»Ÿæ­»é”çš„éš¾é¢˜ã€‚ä»–ä»¬å¦‚æœè¦æ²Ÿé€šåªèƒ½æ€ä¹ˆåšï¼ŸæŠŠè¿™äº›å¤§æ•°æ®å…¨éƒ½ä¸¢åœ¨å¯†å°å®¹å™¨é‡Œï¼ˆä¹Ÿå°±æ˜¯åºåˆ—åŒ–åçš„ \`MessageEvent\`ï¼‰ï¼Œé€šè¿‡ä¸€ç®¡ä¸“æ¥ä¸¤å°å¾®æ³¢æ¥æ”¶å™¨çš„ä¿¡ç®±ä½¿ç”¨å”¯ä¸€çš„åŸè¯­ \`postMessage\` è¿›è¡Œæ‰”ï¼Œå’Œé æŒ‚åœ¨ç›‘å¬ \`onmessage\` ä¸¤ç«¯é€šè¿‡ç›‘å¬æŠŠä¿¡å–å‡ºæ¥æ‹¿èµ°ã€‚è¿™ä¸€å»ä¸€å›ä¸ä»…æ˜¯ç‰©ç†éš”ç¦»æ›´æ˜¯è®¡ç®—èµ„æºé™ç»´æ‰“å‡»çš„ç¥å™¨ã€‚`,
        targetCode: `// ğŸ’¡ Worker çš„å†…æ ¸é€»è¾‘å¿…é¡»æ˜¯ä¸€ä¸ªçº¯å‡€çš„ä¸–ç•Œï¼Œä¸èƒ½è®¿é—® DOM å’Œ windowï¼\nconst sortWorkerStr = \`\n  self.onmessage = function(e) {\n    const { videos, sortBy } = e.data;\n    // ğŸ’¡ æ³¨æ„ï¼šsort ä¼šåœ¨åŸåœ°ä¿®æ”¹æ•°ç»„ï¼Œæˆ‘ä»¬è§£æ„ä¸€ä»½é˜²å‰¯ä½œç”¨\n    const sorted = [...videos].sort((a, b) => {\n      if (sortBy === 'views') return b.views - a.views;\n      return a.title.localeCompare(b.title);\n    });\n    // ğŸ’¡ è®¡ç®—å®ŒååŸè·¯å‘é€å›å»\n    self.postMessage(sorted);\n  };\n\`;\n\nfunction createWorker() {\n  const blob = new Blob([sortWorkerStr], { type: 'application/javascript' });\n  return new Worker(URL.createObjectURL(blob));\n}\n\nimport { useState, useEffect, useRef } from 'react';\n\nexport function useWorkerSort(videos: any[], sortBy: string) {\n  const [sorted, setSorted] = useState(videos);\n  const workerRef = useRef<Worker | null>(null);\n\n  // ğŸ’¡ Init åˆå§‹åŒ–\n  useEffect(() => {\n    workerRef.current = createWorker();\n    workerRef.current.onmessage = (e) => setSorted(e.data);\n    // ğŸ’¡ ç»„ä»¶é”€æ¯æ—¶ææ–­çº¿ç¨‹ç”µæº\n    return () => workerRef.current?.terminate();\n  }, []);\n\n  // ğŸ’¡ æ¯å½“åˆ—è¡¨æˆ–æ’åºæ¡ä»¶æ”¹å˜ï¼Œå‘é€ä»»åŠ¡ç»™å¤šçº¿ç¨‹åå°å¤„ç†\n  useEffect(() => {\n    workerRef.current?.postMessage({ videos, sortBy });\n  }, [videos, sortBy]);\n\n  return sorted;\n}\n`,
        comments: [
            { line: 2, text: '// ğŸ’¡ åœ¨å­çº¿ç¨‹ä¸­æ‰§è¡Œé«˜æ¶ˆè€—æ’åº' },
            { line: 10, text: '// ğŸ’¡ postMessage å¼‚æ­¥å›è°ƒé€šè®¯' },
            { line: 28, text: '// ğŸ’¡ ç›‘å¬ä¼ å›çš„æ’å¥½åºçš„æ•°æ®å¹¶å¼•å‘ React é‡ç»˜' },
        ],
    },
    {
        id: 'fe-2-task', type: 'frontend',
        title: 'å®æˆ˜ï¼šæ•´åˆæ— é™ Feed æµä¸šåŠ¡é—­ç¯',
        category: 'æ¨¡å—2ï¼šç»„ä»¶æ¶æ„ä¸è§†é¢‘æµ', track: 'å‰ç«¯æ¶æ„',
        moduleNumber: 2, lessonNumber: 4, language: 'typescript',
        startingCode: '',
        instructions: `# å¯å‘å¼ç»ˆç»“æˆ˜ï¼šè£…é…ä¸‡æ³•åˆæµçš„å‰ç«¯èšåˆå™¨

## ğŸ¯ ä¸šåŠ¡ä¸Šä¸‹æ–‡ä¸æˆ‘ä»¬åœ¨åšä»€ä¹ˆï¼Ÿ
æ¶æ„å†ç¾å¦‚æœä¸è¿›è¡Œæœ€åä¸€æ­¥çš„é«˜ç²¾å¯†æ‹¼è£…ï¼Œå®ƒåªèƒ½å˜æˆé›¶ç¢çš„æ•£ä»¶ç³»ç»Ÿã€‚æœ¬è¯¾ä½ è¦åƒä¸€ä¸ªå…¨èƒ½å·¥ç¨‹å¸ˆä¸€æ ·æŠŠä½ ä¹‹å‰äº²è‡ªåšçš„æ‹¥æœ‰æŠ—é—­åŒ…å…ç–«èƒ½åŠ›çš„ \`useIntersectionObserver\`ï¼Œå…·æœ‰é˜»æ–­æ— æ•ˆæ¸²æŸ“å¢™çš„ \`VideoCard\` ç­‰ç­‰ï¼Œå®Œç¾æ‹¼æ¥åœ¨ä¸€å¼ ç»Ÿä¸€ç®¡æ§å®è§‚æ•°æ®çš„èšåˆå±•ç¤ºé¡µé¢ \`InfiniteSaaSFeed\` ä¸­ã€‚è¿™æ„æˆå‰ç«¯ç³»ç»Ÿè®¾è®¡é‡Œï¼Œç»å…¸çš„ä¸€æ¡ç”±ä¸‹å‘å¾€ä¸Šçš„â€œè‡ªç ”èšåˆéª¨æ¶æµâ€ã€‚
è¿™ä¸€è¯¾å°±æ˜¯æ£€æµ‹ä½ å¯¹çŠ¶æ€çš„ç»„ç»‡æ–¹å¼ä¸å›è°ƒç†è§£æœ€ç»ˆè€ƒæ ¸æˆ˜åœºã€‚

## ğŸ” ä»£ç æ·±åº¦è§£æ
- **é˜²ç«æ€åŠ è½½é” (\`if (loading) return;\`)**ï¼šè¿™æ˜¯è¯·æ±‚è·å–é¢†åŸŸä¸­æå…¶åŸºç¡€çš„èŠ‚æµå¼€å…³æ‰‹æ®µã€‚å¦‚æœç½‘ç»œå·¨æ…¢æˆ–è€…è¯·æ±‚å»¶è¿Ÿç”±äºæ‰‹æŒ‡å¤´æ»‘çš„è¿‡å¿«å¯¼è‡´åº•å±‚è¿ç•ªæ•°ä¸‡æ¬¡æŠ›å‡ºåˆ°äº†åº•éƒ¨çš„ä¿¡å·ã€‚å¿…é¡»ç”±é”ä¿è¯å‰æ’é‚£å”¯ä¸€ä¸€è‚¡æ•°æ®ä¸‹è½½æ´ªæµè·‘å®Œå½’è¿˜å‰ï¼Œåæ’æ’é˜Ÿçš„éœ€æ±‚å…¨é¢æ–©è½ã€‚
- **å°†äº‹ä»¶æµè§£è€¦åˆ°æè‡´**ï¼šä½ æ³¨æ„åˆ°äº†åœ¨ \`VideoCard\` ä¼ å€¼ä¸­æŒ‚åœ¨é‚£ä¸ªçš„å·¨å‹çš„å†…è¿æ¥ \`onLike\` æ˜¯ä¸ªå®Œå…¨æŠ½è±¡ä¸šåŠ¡æ“ä½œï¼Ÿå¦‚æœå°†ç‚¹èµé‡Œè¿å¾€åç«¯çš„å¼‚æ­¥ API å‘é€è¯·æ±‚éƒ½ç›´æ¥ç»™æœ€åº•å±‚ï¼Œé‚£ä¸ªæŒ‰é’®å°†ä¼šå†ä¹Ÿæ— æ³•åœ¨åªæœ‰æ˜¾ç¤ºéœ€æ±‚æˆ–è€…å…¶ä»–é SaaS ç¯å¢ƒå¤ç”¨ï¼Œè¿™é‡Œå°†çœŸæ­£èƒ½é©±åŠ¨å…¨å±€äº§ç”Ÿè´¨å˜çš„çŠ¶æ€ç•™ç½®äºæ­¤æœ€é«˜ç»Ÿå¸… \`InfiniteSaaSFeed\` è¿›è¡Œä¸šåŠ¡çš„åˆ†æ‰¹ç®¡æ§æ˜¯é«˜è´µçš„å±•ç°ã€‚

### ğŸ§  åº•å±‚åŸç†å‰–æï¼šReact æ‰§è¡Œçš„ç€‘å¸ƒåˆ†æµä¸æŒ‚è½½
**å•å‘æ•°æ®æµæœºåˆ¶ï¼ˆOne-Way Data Flowï¼‰**ï¼š
ä¸ºä»€ä¹ˆæˆ‘ä»¬è¦æŠŠè¿™å‡ åæ¡çŸ­è§†é¢‘åˆ—è¡¨ç»Ÿä¸€ä»¥ \`useState\` ç»´æŠ¤åœ¨æœ€é«˜çš„å±‚çº§è€Œä¸æ˜¯å¡è¿›åº•å±‚çš„ä¸€ä¸ªå°å°çš„åŒºåŸŸå†…ç®¡ç†ï¼Ÿå› ä¸ºç»„ä»¶çš„å½¢æ€å¾€å¾€æ¯”æˆ‘ä»¬è®¤çŸ¥çš„å¤æ‚ç™¾å€ç”šè‡³å‡ºç°ä¸¤ä¸ªå®Œå…¨æ²¡æœ‰éš¶å±å’Œå­çˆ¶å…³ç³»çš„é¡µé¢éƒ½éœ€è¦è®¿é—®åŒä¸€æ‰¹æ¬¡æ­¤æ•°æ®ä»¥å±•ç°ä¸åŒè¡¨è±¡çŠ¶æ€ï¼ˆå¦‚åŒä¸€ä¸ªå³ä¸‹è§’çš„è¿·ä½ ç¼©çº¦æç¤ºç‰ˆé¢ï¼‰ã€‚
è¿™å…¶ä¸­è•´å«äº† React è¿™ä¸ªç”Ÿæ€æå…¶å›ºæ‰§ç”šè‡³å¯ä»¥è¯´æä¸ºç¥åœ£å“²å­¦ç†å¿µï¼šæ‰€æœ‰çš„æºå¤´æµåŠ¨åªèƒ½ç”±é«˜å¤„é¡ºæ²¿ç€é‡åŠ›å¾€ä¸‹ä½œä¸º \`props\` ï¼ˆä¸å¯å˜å‚æ•°ï¼‰å¥”æ³¢åˆ°å­ä»£æ·±è¿œå¤§æµ·ï¼Œä¸é€†è½¬ï¼è¿™ç§å¦‚æ ‘é¡»ææ¡ è„‰ç»œæ•£æ’­çš„æ–¹å¼èƒ½å¤Ÿç»å¯¹ä¿éšœæ•°æ®äº§ç”Ÿä¿®æ”¹å¼•å‘å˜æ›´ç¾éš¾æ—¶ï¼Œé€šè¿‡ç®€å•çš„æºå¤´æº¯æºåœ¨å‡ ç§’ä¹‹å†…ç”¨ \`(prev) => [...prev, ...newVideos]\` åœ¨åŸç‚¹æ‰¾å‡ºã€‚å¦‚æœè¿èƒŒè¿™ä¸ªå°†å¼•èµ·çŠ¹å¦‚è¿·å®«å¤§åå›çš„æ··ä¹±ä¹‹ä¸»ï¼Œä½¿å¾— Bug ä¸å¯æ•è·äº§ç”Ÿæå…¶å¯æ€•çš„æš—æµå˜å¼‚ã€‚è¿™ä¹Ÿä¸ºå°†æ¥é‡‡ç”¨æ·±æ°´åŒºå¤§å‹åŸºå»ºçº¢æµ·ï¼šå¦‚ Zustand ç»™å‡ºäº†å¿…ç„¶å‰ç½®å¼•è·¯ã€‚`,
        targetCode: `import React, { useState, useCallback } from 'react';\nimport { useIntersectionObserver } from '@/hooks/useIntersectionObserver';\nimport { VideoCard } from '@/components/VideoCard';\n\nexport default function InfiniteSaaSFeed() {\n  const [videos, setVideos] = useState<any[]>([]);\n  const [page, setPage] = useState(1);\n  const [loading, setLoading] = useState(false);\n\n  // ğŸ’¡ åˆ†é¡µé€»è¾‘\n  const fetchMore = useCallback(async () => {\n    if (loading) return;\n    setLoading(true);\n    // æ¨¡æ‹Ÿä¸€ä¸‹ä» Spring Boot API æ‹¿æ•°æ®\n    // const res = await fetch(\`/api/videos?page=\${page}&limit=10\`);\n    // const newVideos = await res.json();\n    const newVideos = [{ id: String(Date.now()), title: 'New Hook Tutorial', author: 'CodeForge', views: 50000, thumbnail: 'https://images.unsplash.com/photo-1611162617474-5b21e879e113?q=80&w=300&auto=format&fit=crop' }];\n    \n    setVideos(prev => [...prev, ...newVideos]);\n    setPage(p => p + 1);\n    setLoading(false);\n  }, [page, loading]);\n\n  // ğŸ’¡ æŒ‚æ¥æ— é™æ»šåŠ¨è§¦å‘å™¨\n  const sentinelRef = useIntersectionObserver(fetchMore);\n\n  return (\n    <div className="max-w-4xl mx-auto p-8">\n      <h1 className="text-3xl font-extrabold mb-8 text-gray-900 border-b pb-4">Trending Tech Videos</h1>\n      \n      <div className="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-6">\n        {videos.map(v => (\n          <VideoCard \n            key={v.id} \n            video={v} \n            onLike={(id) => console.log('Liking video ID and pushing to Kafka: ', id)} \n          />\n        ))}\n      </div>\n\n      {/* ğŸ’¡ æ»šåŠ¨åº•éƒ¨çš„å“¨å…µå…ƒç´ ï¼šå®ƒéšè—åœ¨é‚£é‡Œï¼Œéœ²å‡ºè§†å£å°±ä»£è¡¨åˆ°äº†åº•éƒ¨ */}\n      <div ref={sentinelRef} className="h-16 flex items-center justify-center mt-6">\n        {loading && <div className="text-[#4285F4] animate-pulse">Loading next chunk...</div>}\n      </div>\n    </div>\n  );\n}\n`,
        comments: [
            { line: 10, text: '// ğŸ’¡ Fetch æ•°æ®ï¼Œå¿…é¡» useCallback é˜²é—­åŒ…å˜åŠ¨' },
            { line: 23, text: '// ğŸ’¡ å°† fetchMore ä¼ å…¥æˆ‘ä»¬çš„è‡ªå®šä¹‰ Hook' },
            { line: 31, text: '// ğŸ’¡ æ¸²æŸ“è¢« React.memo ä¼˜åŒ–çš„æé€Ÿç»„ä»¶' },
            { line: 41, text: '// ğŸ’¡ è¿™å°±æ˜¯é‚£ä¸ªéœ€è¦è¢«ç»‘å®šçš„å“¨å…µ div' },
        ],
    },
];
