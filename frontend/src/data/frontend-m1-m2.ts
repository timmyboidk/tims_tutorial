import type { Lesson } from '../types';

export const frontendM1M2: Lesson[] = [
    {
        id: 'fe-1-1', type: 'frontend',
        title: 'è¯¾ç¨‹ 1.1ï¼šé…ç½® SaaS é¡¹ç›®çš„ React å¤–å£³',
        category: 'æ¨¡å—1ï¼šç°ä»£åŸºç¡€æ¶æ„ä¸æƒé™', track: 'å‰ç«¯æ¶æ„',
        moduleNumber: 1, lessonNumber: 1, language: 'typescript',
        startingCode: '',
        instructions: `# é…ç½® SaaS é¡¹ç›®çš„ React å¤–å£³\n\n## ä¸šåŠ¡ä¸Šä¸‹æ–‡\nåœ¨å¼€å§‹ç¼–å†™æˆ‘ä»¬â€œçŸ­è§†é¢‘ SaaS çœ‹æ¿â€çš„ä»»ä½•ä¸šåŠ¡ä»£ç å‰ï¼Œæˆ‘ä»¬éœ€è¦ä¸€ä¸ªåšå®çš„åŸºç¡€ã€‚æœ¬é¡¹ç›®å°†é‡‡ç”¨ Vite + React + Tailwind CSSã€‚\n\n## å­¦ä¹ ç›®æ ‡\n- ç†è§£ **Vite** çš„ä»£ç†æœºåˆ¶å¦‚ä½•è§£å†³å‰åç«¯åˆ†ç¦»å¯¼è‡´çš„è·¨åŸŸé—®é¢˜ã€‚\n- æŒæ¡ Tailwind CSS çš„åŸå­åŒ–é…ç½®ã€‚\n\n## âš ï¸ ä¸ºä»€ä¹ˆè¦è¿™ä¹ˆåšï¼Ÿ\næˆ‘ä»¬çš„åç«¯è¿è¡Œåœ¨ \`localhost:8080\`ï¼Œå¦‚æœæˆ‘ä»¬å‰ç«¯ç›´æ¥ \`fetch('localhost:8080/api')\`ï¼Œæµè§ˆå™¨ä¼šæŠ¥é”™ CORSï¼ˆè·¨åŸŸï¼‰ã€‚é€šè¿‡åœ¨ Vite é…ç½®ä¸­åŠ å…¥ä»£ç†ï¼Œæˆ‘ä»¬å¯ä»¥è®©è¯·æ±‚ä¼ªè£…æˆåŒæºã€‚`,
        targetCode: `import { defineConfig } from 'vite';\nimport react from '@vitejs/plugin-react';\nimport tailwindcss from '@tailwindcss/vite';\nimport path from 'path';\n\nexport default defineConfig({\n  plugins: [\n    react(),\n    tailwindcss(),\n  ],\n  resolve: {\n    alias: {\n      // ğŸ’¡ è·¯å¾„åˆ«åï¼šè®©ä½ åœ¨ä»£ç é‡Œä½¿ç”¨ '@/components' è€Œä¸æ˜¯ '../../components'\n      '@': path.resolve(__dirname, './src'),\n    },\n  },\n  server: {\n    port: 5173,\n    proxy: {\n      // ğŸ’¡ ä»£ç†é…ç½®ï¼šè¿™è§£å†³è”è°ƒæ—¶æœ€å¸¸è§çš„ CORS è·¨åŸŸé—®é¢˜\n      // æ‰€æœ‰ /api å¼€å¤´çš„è¯·æ±‚éƒ½ä¼šè¢«é€æ˜è½¬å‘ç»™ Spring Boot åç«¯\n      '/api': {\n        target: 'http://localhost:8080',\n        changeOrigin: true,\n      },\n    },\n  },\n});\n`,
        comments: [
            { line: 13, text: '// ğŸ’¡ è®©æ·±å±‚ç›®å½•å¼•å…¥å˜å¾—ä¼˜é›…' },
            { line: 20, text: '// ğŸ’¡ æ‹¦æˆª /api è¯·æ±‚' },
            { line: 24, text: '// ğŸ’¡ ä¼ªè£…æˆè¯·æ±‚åç«¯çš„ç›®æ ‡åŸŸåï¼Œé¿å¼€ CORS' },
        ],
    },
    {
        id: 'fe-1-2', type: 'frontend',
        title: 'è¯¾ç¨‹ 1.2ï¼šç±»å‹ä¸¥æ ¼çš„ JWT ç™»å½•è¡¨å•',
        category: 'æ¨¡å—1ï¼šç°ä»£åŸºç¡€æ¶æ„ä¸æƒé™', track: 'å‰ç«¯æ¶æ„',
        moduleNumber: 1, lessonNumber: 2, language: 'typescript',
        startingCode: '',
        instructions: `# ç±»å‹ä¸¥æ ¼çš„ç™»å½•è¡¨å•\n\n## ä¸šåŠ¡ä¸Šä¸‹æ–‡\nSaaS ç³»ç»Ÿçš„ç¬¬ä¸€é“é—¨æ§›å°±æ˜¯ç™»å½•ã€‚å½“ç”¨æˆ·è¾“å…¥è´¦å·å¯†ç åï¼Œæˆ‘ä»¬ä¼šè°ƒç”¨ APIï¼Œåç«¯å°†è¿”å›ä¸€ä¸ª JWT Token å’Œ User ä¿¡æ¯ã€‚å¦‚æœæ²¡æœ‰å‡†ç¡®æè¿°è¿”å›ä¿¡æ¯é•¿ä»€ä¹ˆæ ·ï¼Œéšç€ä¸šåŠ¡è¿­ä»£ä½ çš„ä»£ç ææ˜“å‡ºç° \`undefined\` é”™è¯¯ã€‚\n\n## å­¦ä¹ ç›®æ ‡\n- å­¦ä¼šå®šä¹‰ç½‘ç»œè¯·æ±‚çš„ Playload ä¸ Response æ¥å£ï¼ˆInterfacesï¼‰ã€‚\n- ä½¿ç”¨ \`React.FormEvent\` å®šä¹‰äº‹ä»¶ç±»å‹ã€‚\n- ä½¿ç”¨æ³›å‹å¼ºçº¦æŸçŠ¶æ€é’©å­ \`useState<T>\`ã€‚`,
        targetCode: `import React, { useState } from 'react';\n\n// ğŸ’¡ æ¥å£å®šä¹‰äº†åç«¯çš„æ‰¿è¯ºï¼Œè¿™æ˜¯å…¨æ ˆè”è°ƒæ—¶å‰åç«¯æ²Ÿé€šçš„å¥‘çº¦\ninterface LoginResponse {\n  token: string;\n  user: {\n    id: string;\n    username: string;\n    role: 'ADMIN' | 'USER';\n  };\n}\n\nconst LoginForm: React.FC = () => {\n  const [username, setUsername] = useState<string>('');\n  const [password, setPassword] = useState<string>('');\n  // ğŸ’¡ æ³›å‹çº¦æŸï¼šçŠ¶æ€åªèƒ½æ˜¯ Error å¯¹è±¡æˆ– null\n  const [error, setError] = useState<Error | null>(null);\n\n  // ğŸ’¡ æ˜ç¡®å£°æ˜è¿™æ˜¯è¡¨å•çš„æäº¤äº‹ä»¶ï¼Œè·å¾— e.preventDefault() çš„ç±»å‹æ¨å¯¼\n  const handleLogin = async (e: React.FormEvent<HTMLFormElement>) => {\n    e.preventDefault();\n    try {\n      const res = await fetch('/api/auth/login', {\n        method: 'POST',\n        headers: { 'Content-Type': 'application/json' },\n        body: JSON.stringify({ username, password }),\n      });\n      // ğŸ’¡ å¼ºè½¬ç±»å‹ï¼šæˆ‘ä»¬å‘Šè¯‰ç¼–è¯‘å™¨ï¼Œâ€œç›¸ä¿¡æˆ‘ï¼Œè¿”å›å€¼ç¬¦åˆ LoginResponse ç»“æ„â€\n      const data = (await res.json()) as LoginResponse;\n      localStorage.setItem('jwt', data.token);\n    } catch (err) {\n      setError(err instanceof Error ? err : new Error('Login failed'));\n    }\n  };\n\n  return (\n    <form onSubmit={handleLogin} className="p-6 bg-white shadow-md rounded-xl">\n      {error && <p className="text-red-500 mb-4">{error.message}</p>}\n      <input className="block border p-2 mb-2 w-full" type="text" placeholder="Username"\n        value={username} onChange={e => setUsername(e.target.value)} />\n      <input className="block border p-2 mb-4 w-full" type="password" placeholder="Password"\n        value={password} onChange={e => setPassword(e.target.value)} />\n      <button type="submit" className="w-full bg-blue-600 text-white p-2 rounded hover:bg-blue-700">ç™»å½•</button>\n    </form>\n  );\n};\n\nexport default LoginForm;`,
        comments: [
            { line: 3, text: '// ğŸ’¡ å¥‘çº¦ï¼šå®šä¹‰åç«¯è¿”å›çš„æ•°æ®ç»“æ„' },
            { line: 13, text: '// ğŸ’¡ ä¸ºå‡½æ•°ç»„ä»¶æ·»åŠ ç±»å‹å£°æ˜' },
            { line: 16, text: '// ğŸ’¡ å¼ºç±»å‹é˜²æ­¢æ»¥ç”¨å…¶ä»–æ•°æ®ç±»å‹' },
            { line: 19, text: '// ğŸ’¡ React ä¸“å±çš„äº‹ä»¶ç±»å‹' },
            { line: 28, text: '// ğŸ’¡ æ–­è¨€ï¼šå°†æœªçŸ¥çš„ any å‹è½¬åŒ–ä¸ºé¢„è®¾çš„ç»“æ„' },
        ],
    },
    {
        id: 'fe-1-3', type: 'frontend',
        title: 'è¯¾ç¨‹ 1.3ï¼šå¤„ç†è®¤è¯çš„å¼‚æ­¥çŠ¶æ€æœº',
        category: 'æ¨¡å—1ï¼šç°ä»£åŸºç¡€æ¶æ„ä¸æƒé™', track: 'å‰ç«¯æ¶æ„',
        moduleNumber: 1, lessonNumber: 3, language: 'typescript',
        startingCode: '',
        instructions: `# å¤„ç†è®¤è¯çš„å¼‚æ­¥çŠ¶æ€æœº\n\n## ä¸šåŠ¡ä¸Šä¸‹æ–‡\nåœ¨å‘é€ç™»å½•è¯·æ±‚æ—¶ï¼Œä½ çš„é¡µé¢å¯èƒ½å› ä¸ºç½‘ç»œå»¶è¿Ÿå¡ä½ã€‚ä½ éœ€è¦å‘ç”¨æˆ·å±•ç¤º Loading èŠèŠ±å›¾ã€‚ä¸€èˆ¬çš„åšæ³•æ˜¯åˆ†åˆ«ç»´æŠ¤ \`isLoading\` å’Œ \`data\` ä¸¤ä¸ªå˜é‡ï¼Œä½†è¿™ä¼šäº§ç”Ÿâ€œéæ³•çŠ¶æ€â€ï¼ˆæ¯”å¦‚åŒæ—¶ Loading å¹¶æŠ¥é”™ï¼‰ã€‚æˆ‘ä»¬ç”¨ TypeScript ç‰¹æœ‰çš„**å¯åŒºåˆ†è”åˆä½“ï¼ˆDiscriminated Unionsï¼‰**æ¥å½»åº•è§£å†³è¿™ä¸ªé—®é¢˜ã€‚\n\n## å­¦ä¹ ç›®æ ‡\n - ä½¿ç”¨ \`type\` ä½œä¸ºåˆ¤åˆ«å±æ€§ï¼Œæ„å»ºå››ç§ç»å¯¹äº’æ–¥çš„ç½‘è·¯è¯·æ±‚çŠ¶æ€ã€‚`,
        targetCode: `// ğŸ’¡ å¯åŒºåˆ†è”åˆä½“ï¼šstatus æ˜¯é’¥åŒ™ï¼Œå®ƒå†³å®šäº†å¯¹è±¡é‡Œèƒ½å­˜ä»€ä¹ˆæ•°æ®\ntype AuthState =\n  | { status: 'idle' }\n  | { status: 'loading' }\n  | { status: 'success'; token: string }\n  | { status: 'error'; error: string };\n\n// ğŸ’¡ reducer ä»…å…è®¸ä½ è§¦å‘åˆæ³•çš„çŠ¶æ€å˜è¿ï¼Œæ¯”å¦‚ä» FETCH å°±åªèƒ½èµ°å‘ loading\nfunction authReducer(\n  state: AuthState,\n  action: \n    | { type: 'FETCH' }\n    | { type: 'SUCCESS'; token: string }\n    | { type: 'ERROR'; error: string }\n): AuthState {\n  switch (action.type) {\n    case 'FETCH':\n      return { status: 'loading' };\n    case 'SUCCESS':\n      // ğŸ’¡ æ­¤å¤„ TypeScript è¦æ±‚ä½ å¿…é¡»æä¾› tokenï¼Œä¸å¯èƒ½æ¼æ‰\n      return { status: 'success', token: action.token };\n    case 'ERROR':\n      return { status: 'error', error: action.error };\n    default:\n      return state;\n  }\n}\n\n// åœ¨ç»„ä»¶ä¸­ä½¿ç”¨æ¡ˆä¾‹ï¼š\nexport function useAuthMachine() {\n  const [state, dispatch] = React.useReducer(authReducer, { status: 'idle' });\n  // dispatch({ type: 'SUCCESS', token: 'ey...' })\n  return { state, dispatch };\n}\n`,
        comments: [
            { line: 1, text: '// ğŸ’¡ ç”¨åˆ¤åˆ«å±æ€§æ”¶çª„çŠ¶æ€ï¼Œæ¶ˆç­ isLoading å’Œ data æ··ç”¨çš„æƒ…å†µ' },
            { line: 19, text: '// ğŸ’¡ å®‰å…¨çš„ Payload è§£æ„' },
        ],
    },
    {
        id: 'fe-1-task', type: 'frontend',
        title: 'å®æˆ˜ï¼šSaaS çº§å¼ºç±»å‹ Button',
        category: 'æ¨¡å—1ï¼šç°ä»£åŸºç¡€æ¶æ„ä¸æƒé™', track: 'å‰ç«¯æ¶æ„',
        moduleNumber: 1, lessonNumber: 4, language: 'typescript',
        startingCode: '',
        instructions: `# å¯å‘å¼å®æˆ˜ï¼šSaaS çº§å¼ºç±»å‹ UI Button\n\n## ä¸šåŠ¡ä¸Šä¸‹æ–‡\nåœ¨ SaaS çœ‹æ¿ä¸­ï¼Œä½ åˆ°å¤„éœ€è¦æŒ‰é’®ï¼šç™»å½•ã€åˆ é™¤è§†é¢‘ã€å‘é…µæ•°æ®ã€‚æˆ‘ä»¬ä¸è¦æ¯æ¬¡éƒ½æ‰‹å†™ Tailwind æ ·å¼ã€‚è¿™é‡Œè¦æ±‚ä½ ç¼–å†™ä¸€ä¸ªåŸºäºæ³›å‹å’Œå­—é¢é‡è”åˆç±»å‹çš„ Buttonï¼Œå¹¶ä¸”ç”¨ \`Record\` é™å®šæ ·å¼ï¼Œä½¿å¾—å›¢é˜Ÿé‡Œçš„å…¶ä»–äººæ‹¿å»ç”¨æ—¶å¦‚æœå†™é”™äº† \`variant\` å°±ä¼šè¢« TypeScript æŠ¥é”™ã€‚`,
        targetCode: `import React from 'react';\n\n// ğŸ’¡ åªæœ‰è¿™ä¸‰ç§å˜ä½“æ˜¯è¢«å…è®¸çš„ï¼Œå…¶ä»–æ‹¼å†™é”™è¯¯åœ¨ç¼–ç é˜¶æ®µå°±ä¼šå‘Šè­¦\ntype ButtonVariant = 'primary' | 'secondary' | 'danger';\ntype ButtonSize = 'sm' | 'md' | 'lg';\n\n// ğŸ’¡ ç»§æ‰¿åŸç”Ÿ button çš„æ‰€æœ‰å±æ€§ï¼ˆæ¯”å¦‚ type, disabledï¼‰ï¼Œæ— éœ€é‡å¤å£°æ˜\ninterface ButtonProps extends React.ButtonHTMLAttributes<HTMLButtonElement> {\n  variant: ButtonVariant;\n  size: ButtonSize;\n}\n\n// ğŸ’¡ ä½¿ç”¨ Record<K, V> æ˜ å°„ï¼Œç¡®ä¿ä½ ä¸ºæ¯ä¸€ç§å˜ä½“éƒ½æä¾›äº†ç›¸åº”çš„ CSS ç±»\nconst sizeClasses: Record<ButtonSize, string> = {\n  sm: 'px-3 py-1.5 text-sm',\n  md: 'px-4 py-2 text-base',\n  lg: 'px-6 py-3 text-lg',\n};\n\nconst variantClasses: Record<ButtonVariant, string> = {\n  primary: 'bg-[#4285F4] text-white hover:bg-blue-700',\n  secondary: 'bg-gray-100 text-gray-700 hover:bg-gray-200',\n  danger: 'bg-red-600 text-white hover:bg-red-700',\n};\n\nexport function Button({ variant, size, children, className, ...rest }: ButtonProps) {\n  return (\n    <button\n      // ğŸ’¡ è§£æ„åŸç”Ÿå±æ€§å¹¶æ‹¼æ¥æ ¸å¿ƒæ ·å¼\n      className={\`font-medium transition-colors rounded-lg \${sizeClasses[size]} \${variantClasses[variant]} \${className || ''}\`}\n      {...rest}\n    >\n      {children}\n    </button>\n  );\n}\n`,
        comments: [
            { line: 3, text: '// ğŸ’¡ åœ¨å¼€å‘IDEä¸­èƒ½è·å¾—è‡ªåŠ¨æç¤º' },
            { line: 7, text: '// ğŸ’¡ extends ç»§æ‰¿æ˜¯æ„å»ºåŸºç¡€ç»„ä»¶çš„æœ€ä½³å®è·µ' },
            { line: 13, text: '// ğŸ’¡ Record: å¦‚æœä½ æ¼å†™äº† smï¼Œè¿™è¡Œå°±ä¼šæŠ¥é”™ï¼Œé˜²æ­¢ä¸Šçº¿ç¼ºæ ·å¼' },
            { line: 28, text: '// ğŸ’¡ å°†ä½™ä¸‹çš„å¦‚ onClick äº‹ä»¶ç›´æ¥é€ä¼ ç»™åº•å±‚ DOM' },
        ],
    },
    {
        id: 'fe-2-1', type: 'frontend',
        title: 'è¯¾ç¨‹ 2.1ï¼šä¼˜åŒ–çŸ­è§†é¢‘ Feed æµå¡ç‰‡',
        category: 'æ¨¡å—2ï¼šç»„ä»¶æ¶æ„ä¸è§†é¢‘æµ', track: 'å‰ç«¯æ¶æ„',
        moduleNumber: 2, lessonNumber: 1, language: 'typescript',
        startingCode: '',
        instructions: `# ä¼˜åŒ–çŸ­è§†é¢‘ Feed æµå¡ç‰‡\n\n## ä¸šåŠ¡ä¸Šä¸‹æ–‡\nå½“åå°æ•°æ®ä¼ å›æ•°åƒæ¡è§†é¢‘æ—¶ï¼Œä½ åœ¨æµè§ˆå™¨ä¸­è¦æ¸²æŸ“ä¸€ä¸ª Feed æµã€‚å¦‚æœçˆ¶ç»„ä»¶çš„çŠ¶æ€ï¼ˆæ¯”å¦‚é¡¶éƒ¨å…¨å±€è¿‡æ»¤å™¨çš„åˆ‡æ¢ï¼‰å‘ç”Ÿäº†æ”¹å˜ï¼Œæ•´ä¸ªåºå¤§çš„ Feed æµä¼šè¢« React é»˜è®¤å…¨å†›è¦†æ²¡åœ°**é‡æ–°æ¸²æŸ“**ã€‚æˆ‘ä»¬è¦ä¿æŠ¤å¥½è¿™å‡ åä¸‡ä¸ª DOM èŠ‚ç‚¹ã€‚\n\n## å­¦ä¹ ç›®æ ‡\n- ä½¿ç”¨ \`React.memo\`ï¼šå½“ props æ²¡æœ‰å˜åŒ–æ—¶è·³è¿‡é‡ç»˜ã€‚\n- ç»“åˆä¸šåŠ¡é€»è¾‘å®šä¹‰ \`VideoCard\` ç»“æ„ã€‚`,
        targetCode: `import React from 'react';\n\ninterface Video {\n  id: string;\n  title: string;\n  author: string;\n  views: number;\n  thumbnail: string;\n}\n\ninterface VideoCardProps {\n  video: Video;\n  onLike: (id: string) => void;\n}\n\n// ğŸ’¡ React.memo å‘Šè¯‰å¼•æ“ï¼šå¦‚æœä¼ è¿›æ¥çš„ video å’Œ onLike çš„å†…å­˜æŒ‡é’ˆæ²¡æœ‰å˜ï¼Œå°±ä¸è¦é‡åˆ·æˆ‘çš„è€ DOM\nexport const VideoCard = React.memo(function VideoCard({ video, onLike }: VideoCardProps) {\n  // ğŸ’¡ æ¨¡æ‹Ÿä¸€ä¸‹æ˜‚è´µçš„æ¸²æŸ“é€»è¾‘å¼€é”€\n  console.log('Rendering VideoCard:', video.id);\n\n  return (\n    <div className="flex flex-col rounded-xl overflow-hidden bg-white shadow-sm hover:shadow-md transition-shadow">\n      <img src={video.thumbnail} alt={video.title} className="h-48 w-full object-cover" loading="lazy" />\n      <div className="p-4">\n        <h3 className="font-bold text-gray-800 line-clamp-2">{video.title}</h3>\n        <div className="mt-2 flex justify-between items-center text-sm text-gray-500">\n          <span>@{video.author}</span>\n          <span>{(video.views / 1000).toFixed(1)}K views</span>\n        </div>\n        <button \n          // ğŸ’¡ ç‚¹å‡»å‘ä¸Šä¼ é€’äº‹ä»¶ï¼Œäº¤ç”±çˆ¶ç»„ä»¶è°ƒç”¨åç«¯API\n          onClick={() => onLike(video.id)}\n          className="mt-4 w-full py-2 bg-[#E8F0FE] text-[#1967D2] font-medium rounded-lg hover:bg-blue-100"\n        >\n          ç‚¹èµæ”¯æŒ\n        </button>\n      </div>\n    </div>\n  );\n});\n`,
        comments: [
            { line: 15, text: '// ğŸ’¡ React.memo æ‹¦æˆªä¸å¿…è¦çš„ Diff æ¯”å¯¹' },
            { line: 22, text: '// ğŸ’¡ loading="lazy": éå¸¸é‡è¦çš„æ€§èƒ½ä¼˜åŒ–ï¼Œä¸å è§†å£ä¸åŠ è½½å›¾' },
            { line: 30, text: '// ğŸ’¡ Lifting State Up: è®©ä¸šåŠ¡é€»è¾‘æ§åˆ¶æƒç•™åœ¨çˆ¶å±‚' },
        ],
    },
    {
        id: 'fe-2-2', type: 'frontend',
        title: 'è¯¾ç¨‹ 2.2ï¼šæ„å»ºæ— é™æ»šåŠ¨ Hook',
        category: 'æ¨¡å—2ï¼šç»„ä»¶æ¶æ„ä¸è§†é¢‘æµ', track: 'å‰ç«¯æ¶æ„',
        moduleNumber: 2, lessonNumber: 2, language: 'typescript',
        startingCode: '',
        instructions: `# æ„å»ºæ— é™æ»šåŠ¨ Custom Hook\n\n## ä¸šåŠ¡ä¸Šä¸‹æ–‡\næ‰€æœ‰çŸ­è§†é¢‘æ¶æ„ï¼ˆå¦‚æŠ–éŸ³/TikTokï¼‰éƒ½é‡‡ç”¨å‘ä¸‹åˆ’æ— çº¿åŠ è½½çš„äº¤äº’ã€‚è¿™ä¾èµ–äºæµè§ˆå™¨çš„ IntersectionObserver APIï¼ˆå½“åº•éƒ¨çš„å ä½å…ƒç´ æ»šè¿›å±å¹•å°±å‘è¯·æ±‚ï¼‰ã€‚ä¸ºäº†åœ¨é¡¹ç›®ä¸­åå¤å¤ç”¨ï¼Œæˆ‘ä»¬å°†å…¶æå–ä¸ºä¸€ä¸ª \`useIntersectionObserver\` Hookã€‚\n\n## å­¦ä¹ ç›®æ ‡\n- è®¾è®¡é«˜çº§å¯å¤ç”¨ React Hookã€‚\n- ä½¿ç”¨ \`useRef\` ä¿ç•™å›è°ƒå¼•ç”¨ä»¥æŠµå¾¡é—­åŒ…é™·é˜±ã€‚`,
        targetCode: `import { useEffect, useRef } from 'react';\n\n// ğŸ’¡ è¿™ä¸ª Hook çš„ä½œç”¨æ˜¯ï¼šå½“ä½ ç»™å®ƒçš„å…ƒç´ éœ²è„¸ï¼ˆç›¸äº¤ï¼‰æ—¶ï¼Œå®ƒå°±æ‰§è¡Œä½ çš„ callbackã€‚\nexport function useIntersectionObserver(\n  callback: () => void,\n  options?: IntersectionObserverInit\n) {\n  const targetRef = useRef<HTMLDivElement>(null);\n  \n  // ğŸ’¡ useRef(callback) - [ç ´è§£é—­åŒ…é™·é˜±çš„æ ¸å¿ƒ] \n  // ç”±äº callback åœ¨çˆ¶ç»„ä»¶å†…å¯èƒ½ä¼šé¢‘ç¹é‡ç°ï¼ˆæ¯”å¦‚å¸¦æœ‰ page çŠ¶æ€ï¼‰ï¼Œ\n  // è¿™ä¸ª ref ä¼šä¿è¯ observer.observe å†…è§¦å‘çš„å§‹ç»ˆæ˜¯æœ€æ–°çš„é€»è¾‘å¼•ç”¨ã€‚\n  const callbackRef = useRef(callback);\n  \n  useEffect(() => {\n    callbackRef.current = callback;\n  }, [callback]);\n\n  useEffect(() => {\n    const target = targetRef.current;\n    if (!target) return;\n\n    const observer = new IntersectionObserver(([entry]) => {\n      // ğŸ’¡ åœ¨äº¤å‰ä¸”å›è°ƒå­˜åœ¨æ—¶æ‰§è¡ŒåŠ¨ä½œ\n      if (entry.isIntersecting) {\n        callbackRef.current();\n      }\n    }, { threshold: 0.1, ...options });\n\n    observer.observe(target);\n    // ğŸ’¡ è®°å¾—æ¸…ç†ç›‘å¬å™¨\n    return () => observer.disconnect();\n  }, [options]);\n\n  return targetRef;\n}\n`,
        comments: [
            { line: 3, text: '// ğŸ’¡ å°è£… DOM Observer ä½¿å¾—ä¸šåŠ¡å±‚åªå…³å¿ƒ "éœ²è„¸äº†è¯¥å¹²å˜›"' },
            { line: 10, text: '// ğŸ’¡ æŒä¹…åŒ–å­˜æ”¾æœ€æ–°çš„ callback å‡½æ•°ä½“' },
            { line: 24, text: '// ğŸ’¡ entry.isIntersecting åˆ¤æ–­æ˜¯å¦ä»åº•ä¸‹å·ä¸Šæ¥äº†' },
        ],
    },
    {
        id: 'fe-2-3', type: 'frontend',
        title: 'è¯¾ç¨‹ 2.3ï¼šä½¿ç”¨ Web Worker å¸è½½æ’åºè®¡ç®—',
        category: 'æ¨¡å—2ï¼šç»„ä»¶æ¶æ„ä¸è§†é¢‘æµ', track: 'å‰ç«¯æ¶æ„',
        moduleNumber: 2, lessonNumber: 3, language: 'typescript',
        startingCode: '',
        instructions: `# ä½¿ç”¨ Web Worker å¸è½½ç¹é‡è®¡ç®—\n\n## ä¸šåŠ¡ä¸Šä¸‹æ–‡\nå½“æ•°æ®çœ‹æ¿é‡Œç¼“å­˜äº†æ•°åƒæ¡çŸ­è§†é¢‘æ•°æ®æ—¶ï¼Œå¦‚æœç”¨æˆ·ç‚¹å‡»äº†â€œæŒ‰çƒ­åº¦æ’åºâ€ï¼Œç›´æ¥åœ¨ä¸»çº¿ç¨‹ä¸­è¿›è¡Œ \`Array.prototype.sort()\` ä¼šå¯¼è‡´ React å¡æ­»ç½‘é¡µï¼ŒåŠ¨ç”»æ‰å¸§ã€‚æˆ‘ä»¬å°†è®¡ç®—ä»ä¸»èˆªé“å‰¥ç¦»ï¼ŒæŠ›å…¥ Web Worker è¡Œæ˜Ÿå‘åŠ¨æœºä¸­å¼‚æ­¥è®¡ç®—ã€‚\n\n## å­¦ä¹ ç›®æ ‡\n- \`Blob(..)\` åŠ¨æ€åˆ›å»ºç‹¬ç«‹çº¿ç¨‹ç¯å¢ƒã€‚`,
        targetCode: `// ğŸ’¡ Worker çš„å†…æ ¸é€»è¾‘å¿…é¡»æ˜¯ä¸€ä¸ªçº¯å‡€çš„ä¸–ç•Œï¼Œä¸èƒ½è®¿é—® DOM å’Œ windowï¼\nconst sortWorkerStr = \`\n  self.onmessage = function(e) {\n    const { videos, sortBy } = e.data;\n    // ğŸ’¡ æ³¨æ„ï¼šsort ä¼šåœ¨åŸåœ°ä¿®æ”¹æ•°ç»„ï¼Œæˆ‘ä»¬è§£æ„ä¸€ä»½é˜²å‰¯ä½œç”¨\n    const sorted = [...videos].sort((a, b) => {\n      if (sortBy === 'views') return b.views - a.views;\n      return a.title.localeCompare(b.title);\n    });\n    // ğŸ’¡ è®¡ç®—å®ŒååŸè·¯å‘é€å›å»\n    self.postMessage(sorted);\n  };\n\`;\n\nfunction createWorker() {\n  const blob = new Blob([sortWorkerStr], { type: 'application/javascript' });\n  return new Worker(URL.createObjectURL(blob));\n}\n\nimport { useState, useEffect, useRef } from 'react';\n\nexport function useWorkerSort(videos: any[], sortBy: string) {\n  const [sorted, setSorted] = useState(videos);\n  const workerRef = useRef<Worker | null>(null);\n\n  // ğŸ’¡ Init åˆå§‹åŒ–\n  useEffect(() => {\n    workerRef.current = createWorker();\n    workerRef.current.onmessage = (e) => setSorted(e.data);\n    // ğŸ’¡ ç»„ä»¶é”€æ¯æ—¶ææ–­çº¿ç¨‹ç”µæº\n    return () => workerRef.current?.terminate();\n  }, []);\n\n  // ğŸ’¡ æ¯å½“åˆ—è¡¨æˆ–æ’åºæ¡ä»¶æ”¹å˜ï¼Œå‘é€ä»»åŠ¡ç»™å¤šçº¿ç¨‹åå°å¤„ç†\n  useEffect(() => {\n    workerRef.current?.postMessage({ videos, sortBy });\n  }, [videos, sortBy]);\n\n  return sorted;\n}\n`,
        comments: [
            { line: 2, text: '// ğŸ’¡ åœ¨å­çº¿ç¨‹ä¸­æ‰§è¡Œé«˜æ¶ˆè€—æ’åº' },
            { line: 10, text: '// ğŸ’¡ postMessage å¼‚æ­¥å›è°ƒé€šè®¯' },
            { line: 28, text: '// ğŸ’¡ ç›‘å¬ä¼ å›çš„æ’å¥½åºçš„æ•°æ®å¹¶å¼•å‘ React é‡ç»˜' },
        ],
    },
    {
        id: 'fe-2-task', type: 'frontend',
        title: 'å®æˆ˜ï¼šæ•´åˆæ— é™ Feed æµä¸šåŠ¡é—­ç¯',
        category: 'æ¨¡å—2ï¼šç»„ä»¶æ¶æ„ä¸è§†é¢‘æµ', track: 'å‰ç«¯æ¶æ„',
        moduleNumber: 2, lessonNumber: 4, language: 'typescript',
        startingCode: '',
        instructions: `# å¯å‘å¼å®æˆ˜ï¼šèšåˆåŠŸèƒ½ï¼Œç»„è£…è§†é¢‘æµç•Œé¢\n\n## ä¸šåŠ¡ä¸Šä¸‹æ–‡\nåœ¨è¿™èŠ‚è¯¾é‡Œï¼Œä½ éœ€è¦åƒæ‹¼è£…ä¹é«˜ä¸€æ ·ï¼ŒæŠŠæˆ‘ä»¬åšå¥½çš„ \`useIntersectionObserver\`ã€\`VideoCard\` ç»™ä¸²èµ·æ¥ã€‚ä¸€æ—¦åˆ°åº•éƒ¨è‡ªåŠ¨è·å– \`/api/feed/page=...\`ï¼Œå®Œæˆæˆ‘ä»¬çš„æ ¸å¿ƒå‰ç«¯æ¡†æ¶å±•ç°ã€‚è¿™æ˜¯ä¸€ä¸ªæå…¶æ ‡å‡†çš„ä¸šåŠ¡é—­ç¯ã€‚`,
        targetCode: `import React, { useState, useCallback } from 'react';\nimport { useIntersectionObserver } from '@/hooks/useIntersectionObserver';\nimport { VideoCard } from '@/components/VideoCard';\n\nexport default function InfiniteSaaSFeed() {\n  const [videos, setVideos] = useState<any[]>([]);\n  const [page, setPage] = useState(1);\n  const [loading, setLoading] = useState(false);\n\n  // ğŸ’¡ åˆ†é¡µé€»è¾‘\n  const fetchMore = useCallback(async () => {\n    if (loading) return;\n    setLoading(true);\n    // æ¨¡æ‹Ÿä¸€ä¸‹ä» Spring Boot API æ‹¿æ•°æ®\n    // const res = await fetch(\`/api/videos?page=\${page}&limit=10\`);\n    // const newVideos = await res.json();\n    const newVideos = [{ id: String(Date.now()), title: 'New Hook Tutorial', author: 'CodeForge', views: 50000, thumbnail: 'https://images.unsplash.com/photo-1611162617474-5b21e879e113?q=80&w=300&auto=format&fit=crop' }];\n    \n    setVideos(prev => [...prev, ...newVideos]);\n    setPage(p => p + 1);\n    setLoading(false);\n  }, [page, loading]);\n\n  // ğŸ’¡ æŒ‚æ¥æ— é™æ»šåŠ¨è§¦å‘å™¨\n  const sentinelRef = useIntersectionObserver(fetchMore);\n\n  return (\n    <div className="max-w-4xl mx-auto p-8">\n      <h1 className="text-3xl font-extrabold mb-8 text-gray-900 border-b pb-4">Trending Tech Videos</h1>\n      \n      <div className="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-6">\n        {videos.map(v => (\n          <VideoCard \n            key={v.id} \n            video={v} \n            onLike={(id) => console.log('Liking video ID and pushing to Kafka: ', id)} \n          />\n        ))}\n      </div>\n\n      {/* ğŸ’¡ æ»šåŠ¨åº•éƒ¨çš„å“¨å…µå…ƒç´ ï¼šå®ƒéšè—åœ¨é‚£é‡Œï¼Œéœ²å‡ºè§†å£å°±ä»£è¡¨åˆ°äº†åº•éƒ¨ */}\n      <div ref={sentinelRef} className="h-16 flex items-center justify-center mt-6">\n        {loading && <div className="text-[#4285F4] animate-pulse">Loading next chunk...</div>}\n      </div>\n    </div>\n  );\n}\n`,
        comments: [
            { line: 10, text: '// ğŸ’¡ Fetch æ•°æ®ï¼Œå¿…é¡» useCallback é˜²é—­åŒ…å˜åŠ¨' },
            { line: 23, text: '// ğŸ’¡ å°† fetchMore ä¼ å…¥æˆ‘ä»¬çš„è‡ªå®šä¹‰ Hook' },
            { line: 31, text: '// ğŸ’¡ æ¸²æŸ“è¢« React.memo ä¼˜åŒ–çš„æé€Ÿç»„ä»¶' },
            { line: 41, text: '// ğŸ’¡ è¿™å°±æ˜¯é‚£ä¸ªéœ€è¦è¢«ç»‘å®šçš„å“¨å…µ div' },
        ],
    },
];
