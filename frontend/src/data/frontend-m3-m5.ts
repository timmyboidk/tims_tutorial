import type { Lesson } from '../types';

export const frontendM3M5: Lesson[] = [
    {
        id: 'fe-3-1', type: 'frontend',
        title: 'è¯¾ç¨‹ 3.1ï¼šNext.js SSR å¤„ç†è§†é¢‘è¯¦æƒ…é¡µ',
        category: 'æ¨¡å—3ï¼šNext.js ä¸æœåŠ¡ç«¯æ¸²æŸ“', track: 'å‰ç«¯æ¶æ„',
        moduleNumber: 3, lessonNumber: 1, language: 'typescript',
        startingCode: '',
        instructions: `# ä½¿ç”¨ Server-Side Rendering æå‡è§†é¢‘ SEO\n\n## ä¸šåŠ¡ä¸Šä¸‹æ–‡\nåœ¨çŸ­è§†é¢‘ SaaS å¹³å°ä¸­ï¼Œåˆ†äº«ç»™æœ‹å‹çš„ç‹¬ç«‹è§†é¢‘é¡µï¼ˆæ¯”å¦‚ \`/video/123\`ï¼‰å¿…é¡»å…·å¤‡å‡ºè‰²çš„ SEO è¡¨ç°ï¼Œè¿™æ ·åœ¨å¾®ä¿¡ã€Twitter ä¸­åˆ†äº«æ—¶æ‰ä¼šæœ‰æ¼‚äº®çš„ç¤¾äº¤é¢„è§ˆå¡ç‰‡ã€‚ä¼ ç»Ÿçš„ React SPA åšä¸åˆ°è¿™ä¸€ç‚¹ã€‚\n\n## å­¦ä¹ ç›®æ ‡\n- åœ¨ Next.js ä¸­åˆ©ç”¨æœåŠ¡ç«¯æ¸²æŸ“ (SSR) åŠ¨æ€ç”Ÿæˆè¢«æœç´¢å¼•æ“çˆ¬å–çš„ \`<meta>\` æ ‡ç­¾ã€‚\n- ç¼–å†™ \`generateMetadata\` æŠ“å–åç«¯ API å¹¶æ³¨å…¥æ ‡é¢˜ã€‚`,
        targetCode: `import type { Metadata } from 'next';\nimport VideoPlayer from '@/components/VideoPlayer';\n\n// ğŸ’¡ åŠ¨æ€ç”Ÿæˆé¡µé¢çš„ Meta æ ‡ç­¾ï¼Œè¿™å¯¹ SaaS è¥é”€è‡³å…³é‡è¦\nexport async function generateMetadata({ params }: { params: { id: string } }): Promise<Metadata> {\n  // è¿™é‡Œåœ¨ Node.js æœåŠ¡å™¨ç«¯è¿è¡Œ\n  const res = await fetch(\`http://localhost:8080/api/videos/\${params.id}\`);\n  const video = await res.json();\n  \n  return {\n    title: \`\${video.title} - çŸ­è§†é¢‘ SaaS\`, // ğŸ’¡ ç»™çˆ¬è™«çœ‹çš„\n    description: video.description,\n    openGraph: { images: [video.thumbnail] } // ğŸ’¡ åœ¨ç¤¾äº¤åª’ä½“åˆ†äº«æ—¶çš„å°é¢å›¾\n  };\n}\n\n// ğŸ’¡ Next.js æœåŠ¡ç«¯ç»„ä»¶æ¸²æŸ“é¡µé¢ HTML\nexport default async function VideoPage({ params }: { params: { id: string } }) {\n  const res = await fetch(\`http://localhost:8080/api/videos/\${params.id}\`);\n  const video = await res.json();\n\n  return (\n    <main className="max-w-4xl mx-auto p-4">\n      <h1 className="text-2xl font-bold mb-4">{video.title}</h1>\n      {/* ğŸ’¡ å‘é€å®Œæ•´çš„åŒ…å« Video DOM çš„ HTML å›åˆ°ç»ˆç«¯æµè§ˆå™¨ */}\n      <VideoPlayer url={video.url} />\n    </main>\n  );\n}\n`,
        comments: [
            { line: 5, text: '// ğŸ’¡ åŠ¨æ€æå–å‚æ•°å¹¶è¯·æ±‚åç«¯ï¼Œäº§å‡ºç²¾å‡† SEO å†…å®¹' },
            { line: 11, text: '// ğŸ’¡ è®©æ¯ä¸ªè§†é¢‘é¡µåœ¨å¾®ä¿¡é‡Œéƒ½æœ‰ç‹¬ç«‹çš„å°é¢ä¸æ ‡é¢˜' },
            { line: 24, text: '// ğŸ’¡ è¿™æ®µ HTML ä¼šè¢«çˆ¬è™«å®Œç¾è§£æ' },
        ],
    },
    {
        id: 'fe-3-2', type: 'frontend',
        title: 'è¯¾ç¨‹ 3.2ï¼šReact Server Components å¤„ç†è¶…é•¿è¯„è®º',
        category: 'æ¨¡å—3ï¼šNext.js ä¸æœåŠ¡ç«¯æ¸²æŸ“', track: 'å‰ç«¯æ¶æ„',
        moduleNumber: 3, lessonNumber: 2, language: 'typescript',
        startingCode: '',
        instructions: `# React Server Components è·å–å¤§æ•°æ®\n\n## ä¸šåŠ¡ä¸Šä¸‹æ–‡\næœ‰äº›çƒ­é—¨è§†é¢‘å¯èƒ½æœ‰æˆåƒä¸Šä¸‡æ¡é™æ€è¯„è®ºã€‚å¦‚æœæŠŠè¿™äº›æ•°æ®å…¨å¡ç»™å®¢æˆ·ç«¯å»ä¸‹è½½å¹¶ç”¨ JS æ¸²æŸ“ï¼Œç”¨æˆ·çš„æ‰‹æœºä¼šå‘çƒ«ç”šè‡³é—ªé€€ã€‚ä½¿ç”¨ RSC (React Server Components)ï¼Œæˆ‘ä»¬åªæŠŠæ¸²æŸ“å¥½çš„æœ€ç»ˆ HTML ä¼ ç»™æ‰‹æœºã€‚\n\n## å­¦ä¹ ç›®æ ‡\n- ä»…é™æœåŠ¡ç«¯çš„ç»„ä»¶ï¼ˆæ—  \`useState\` è´Ÿæ‹…ï¼‰ã€‚\n- é€šè¿‡åŸç”Ÿ \`fetch\` åœ¨æœåŠ¡ç«¯ä¸ Spring Boot å†…ç½‘ç›´æ¥é€šä¿¡ã€‚`,
        targetCode: `// ğŸ’¡ æ³¨æ„ï¼šé»˜è®¤æƒ…å†µä¸‹ï¼ŒNext.js App Router é‡Œçš„æ‰€æœ‰ç»„ä»¶éƒ½æ˜¯ RSC\nimport React from 'react';\n\ninterface Comment {\n  id: string;\n  userId: string;\n  content: string;\n  createdAt: string;\n}\n\n// ğŸ’¡ è¿™æ˜¯ä¸€ä¸ª async ç»„ä»¶ï¼Œåªæœ‰åœ¨æœåŠ¡ç«¯æ‰èƒ½è¿™ä¹ˆå†™\nexport default async function CommentsSection({ videoId }: { videoId: string }) {\n  // ğŸ’¡ åœ¨ä¼ä¸šçº§é›†ç¾¤ä¸­ï¼Œè¿™ä¸ª fetch èµ°çš„æ˜¯å†…ç½‘ï¼Œæ¯«ç§’çº§å»¶è¿Ÿ\n  const res = await fetch(\`http://api-service:8080/api/videos/\${videoId}/comments\`, {\n    next: { revalidate: 60 } // ğŸ’¡ ISR ç¼“å­˜ï¼Œæ¯ 60 ç§’æ‰çœŸæ­£å»åç«¯æŸ¥ä¸€æ¬¡\n  });\n  const comments: Comment[] = await res.json();\n\n  return (\n    <section className="mt-8">\n      <h2 className="text-xl font-semibold mb-4 border-b pb-2">ç½‘å‹è¯„è®º ({comments.length})</h2>\n      <div className="space-y-4">\n        {comments.map((c) => (\n          <div key={c.id} className="p-4 bg-gray-50 rounded-lg">\n            <div className="flex justify-between text-sm text-gray-500 mb-2">\n              <span>ç”¨æˆ· {c.userId}</span>\n              <span>{new Date(c.createdAt).toLocaleDateString()}</span>\n            </div>\n            <p className="text-gray-800">{c.content}</p>\n          </div>\n        ))}\n      </div>\n    </section>\n  );\n}\n`,
        comments: [
            { line: 12, text: '// ğŸ’¡ å¹¶å‘ä¸æ•°æ®ç›´æ¥åœ¨æœåŠ¡ç«¯ç»„è£…ï¼Œä¸å ç”¨æ‰‹æœºèµ„æº' },
            { line: 15, text: '// ğŸ’¡ æ€§èƒ½å…³é”®ï¼šä¸€åˆ†é’Ÿå†…çš„æ‰€æœ‰ç”¨æˆ·è®¿é—®éƒ½åƒè¿™ä¸ªå¸¦é™æ€é¡µé¢çš„ç¼“å­˜ï¼' },
            { line: 26, text: '// ğŸ’¡ å‘é€åˆ°æµè§ˆå™¨çš„åªæœ‰è¿™æ®µçº¯çº¯çš„ HTMLï¼Œä½“ç§¯æå°' },
        ],
    },
    {
        id: 'fe-3-3', type: 'frontend',
        title: 'è¯¾ç¨‹ 3.3ï¼šå²›å±¿æ¶æ„ä¸äº’åŠ¨ç‚¹èµ',
        category: 'æ¨¡å—3ï¼šNext.js ä¸æœåŠ¡ç«¯æ¸²æŸ“', track: 'å‰ç«¯æ¶æ„',
        moduleNumber: 3, lessonNumber: 3, language: 'typescript',
        startingCode: '',
        instructions: `# å²›å±¿æ¶æ„ï¼šé™æ€æµ·æ´‹ä¸­çš„äº’åŠ¨å­¤å²›\n\n## ä¸šåŠ¡ä¸Šä¸‹æ–‡\nåˆšæ‰çš„è¯¦æƒ…é¡µå’Œè¯„è®ºåŒºéƒ½æ˜¯æœåŠ¡ç«¯æ¸²æŸ“çš„é™æ€ HTMLï¼Œå®Œå…¨ä¸éœ€è¦æ‰§è¡Œ JSã€‚å¯æ˜¯â€œç‚¹èµâ€æŒ‰é’®å¿…é¡»æ˜¯æ´»çš„ï¼ç‚¹å®ƒåº”è¯¥å˜è‰²ï¼Œè€Œä¸”è¦å‘åç«¯çš„ Kafka é˜Ÿåˆ—å‘æ¶ˆæ¯ã€‚æˆ‘ä»¬å°†å®ƒå®šä¹‰ä¸ºä¸€ä¸ª Client Componentï¼ˆå®¢æˆ·ç«¯ç»„ä»¶/äº’åŠ¨å²›å±¿ï¼‰ã€‚\n\n## å­¦ä¹ ç›®æ ‡\n- \`'use client'\` æŒ‡ä»¤åœˆå®šäº¤äº’åœ°å¸¦ã€‚\n- ä¹è§‚ UI æ›´æ–°ï¼ˆOptimistic UI Updateï¼‰ã€‚`,
        targetCode: `// ğŸ’¡ è¿™è¡Œä»£ç æ˜¯ç•Œé™ï¼šå‘Šè¯‰ Next.js è¿™é‡Œéœ€è¦å‘é€ React JS ä»£ç åˆ°æµè§ˆå™¨\n'use client';\n\nimport { useState } from 'react';\n\ninterface LikeButtonProps {\n  videoId: string;\n  initialLikes: number;\n}\n\nexport function InteractiveLikeButton({ videoId, initialLikes }: LikeButtonProps) {\n  const [likes, setLikes] = useState(initialLikes);\n  const [isLiked, setIsLiked] = useState(false);\n\n  const handleLike = async () => {\n    // ğŸ’¡ ä¹è§‚æ›´æ–°ï¼šä¸ç­‰åç«¯è¿”å›ï¼Œç«‹åˆ»æŠŠæ•° +1 å˜çº¢ï¼Œç»™ç”¨æˆ·æé€Ÿçš„åé¦ˆä½“éªŒ\n    setIsLiked(!isLiked);\n    setLikes((prev) => (isLiked ? prev - 1 : prev + 1));\n\n    try {\n      // ğŸ’¡ ä¸‹å‘ç»™åç«¯ï¼Œåç«¯ä¼šæŠŠè¿™ä¸ªè¡Œä¸ºæŠ›å…¥ Kafka æ¶ˆæ¯é˜Ÿåˆ—å¼‚æ­¥æŒä¹…åŒ–\n      await fetch(\`/api/videos/\${videoId}/like\`, {\n        method: 'POST',\n        headers: { Authorization: \`Bearer \${localStorage.getItem('jwt')}\` }\n      });\n    } catch (e) {\n      // ğŸ’¡ å¦‚æœè¯·æ±‚å¤±è´¥ï¼Œå¿…é¡»å›æ»šåˆšæ‰çš„ä¹è§‚çŠ¶æ€\n      setIsLiked(isLiked);\n      setLikes((prev) => (isLiked ? prev + 1 : prev - 1));\n      alert('ç‚¹èµå¤±è´¥ï¼Œè¯·æ£€æŸ¥ç½‘ç»œ');\n    }\n  };\n\n  return (\n    <button \n      onClick={handleLike}\n      className={\`font-bold py-2 px-6 rounded-full transition-transform active:scale-95 \${\n        isLiked ? 'bg-red-500 text-white' : 'bg-gray-200 text-gray-700'\n      }\`}\n    >\n      {isLiked ? 'â¤ï¸ å·²èµ' : 'ğŸ¤ ç‚¹èµ'} {likes.toLocaleString()}\n    </button>\n  );\n}\n`,
        comments: [
            { line: 2, text: '// ğŸ’¡ æ¿€æ´»æµè§ˆå™¨çš„ onClick ä¸ useState æœºèƒ½' },
            { line: 17, text: '// ğŸ’¡ è¿™æ˜¯ SaaS ç”¨æˆ·ä½“éªŒçš„çµé­‚ï¼šç»ä¸è®©ç”¨æˆ·ç­‰ç½‘ç»œè½¬åœˆ' },
            { line: 28, text: '// ğŸ’¡ å…œåº•æªæ–½ï¼šå‘ç”Ÿæ„å¤–æ—¶æŠŠ UI è¿˜åŸ' },
        ],
    },
    {
        id: 'fe-4-1', type: 'frontend',
        title: 'è¯¾ç¨‹ 4.1ï¼šæ„å»º SaaS è¿è¥æ•°æ®çœ‹æ¿',
        category: 'æ¨¡å—4ï¼šSaaS æ´å¯Ÿçœ‹æ¿', track: 'å‰ç«¯æ¶æ„',
        moduleNumber: 4, lessonNumber: 1, language: 'typescript',
        startingCode: '',
        instructions: `# æ„å»ºä¼ä¸šçº§æ•°æ®çœ‹æ¿ UI\n\n## ä¸šåŠ¡ä¸Šä¸‹æ–‡\næˆ‘ä»¬çš„çŸ­è§†é¢‘è¿è¥äººå‘˜æ¯å¤©éœ€è¦ç›‘æ§â€œç‚¹èµæ•°â€ã€â€œæ–°å¢é‡â€ã€â€œKafka æ¶ˆè´¹å»¶è¿Ÿâ€ç­‰æ ¸å¿ƒæŒ‡æ ‡ã€‚ç”¨ Tailwind CSS æ„å»ºä¸€ä¸ªç°ä»£ã€ç¾è§‚çš„æ•°æ®å¡ç‰‡ç½‘æ ¼ç³»ç»Ÿæ˜¯è¿™èŠ‚è¯¾çš„ç›®æ ‡ã€‚\n\n## å­¦ä¹ ç›®æ ‡\n- CSS Grid æ„å»ºç«‹ä½“åŒ–å¸ƒå±€æ¡†æ¶ã€‚\n- è®¾è®¡å¯ä¼ å‚çš„æ•°æ®å¤§å± Stats Cardã€‚\n- Tailwind é€æ˜åº¦èƒŒæ™¯å åŠ æŠ€å·§ã€‚`,
        targetCode: `import React from 'react';\n\ninterface StatProps {\n  title: string;\n  value: number | string;\n  trend: number;\n  info: string;\n}\n\n// ğŸ’¡ åŸå­ç»„ä»¶ï¼šSaaS ä»ªè¡¨ç›˜ä¸­åˆ°å¤„å¯è§çš„æŒ‡æ ‡å¡ç‰‡\nconst StatCard = ({ title, value, trend, info }: StatProps) => (\n  <div className="bg-white rounded-xl border border-gray-100 p-6 flex flex-col shadow-sm relative overflow-hidden">\n    <h3 className="text-gray-500 text-sm font-medium mb-1">{title}</h3>\n    <div className="text-3xl font-extrabold text-[#202124]">{value}</div>\n    \n    <div className="mt-4 flex items-center justify-between">\n      <span className={\`text-xs font-bold \${trend > 0 ? 'text-green-500' : 'text-red-500'}\`}>\n        {trend > 0 ? 'â†‘' : 'â†“'} {Math.abs(trend)}% ä»ä¸Šå‘¨\n      </span>\n      <span className="text-xs text-gray-400">{info}</span>\n    </div>\n    \n    {/* ğŸ’¡ è£…é¥°æ€§çš„è‰²å—ï¼šå¢åŠ ç•Œé¢å‘¼å¸æ„Ÿä¸é«˜çº§æ„Ÿ */}\n    <div className="absolute top-0 right-0 -mt-4 -mr-4 w-16 h-16 bg-[#4285F4] opacity-5 rounded-full blur-2xl"></div>\n  </div>\n);\n\nexport default function DashboardGrid() {\n  return (\n    <div className="p-8 bg-gray-50 min-h-screen">\n      <h1 className="text-2xl font-bold text-gray-900 mb-8">è¿è¥ä¸­æ§å° / KPI</h1>\n      \n      {/* ğŸ’¡ å“åº”å¼ Gridï¼šæ‰‹æœºä¸Š1åˆ—ï¼Œå¹³æ¿2åˆ—ï¼Œæå®½æ¡Œé¢4åˆ— */}\n      <div className="grid grid-cols-1 md:grid-cols-2 xl:grid-cols-4 gap-6">\n        <StatCard title="ä»Šæ—¥æ€»ç‚¹èµè¯·æ±‚ (Kafka)" value="2,405,119" trend={12.5} info="è¿‡å»24å°æ—¶" />\n        <StatCard title="è§†é¢‘çƒ­ç‚¹å‘½ä¸­ç‡ (Redis)" value="98.2%" trend={0.4} info="ç¼“å­˜ Miss ç‡ <2%" />\n        <StatCard title="æ–°å¢æ³¨å†Œç”¨æˆ·" value="14,233" trend={-2.1} info="åŒ…å«å¾®ä¿¡/æ‰‹æœºå·" />\n        <StatCard title="Kafka DLQ å †ç§¯å¼‚å¸¸" value="0" trend={0} info="ç³»ç»Ÿè¿è¡Œå¥åº·" />\n      </div>\n    </div>\n  );\n}\n`,
        comments: [
            { line: 12, text: '// ğŸ’¡ border ä¸ shadow-sm çš„ç»„åˆæˆå°±äº†ç»å…¸çš„ç°ä»£å¡ç‰‡è´¨æ„Ÿ' },
            { line: 17, text: '// ğŸ’¡ å•†ä¸šæŒ‡æ ‡å°‘ä¸äº†è¶‹åŠ¿ç®­å¤´ï¼Œç”¨é¢œè‰²å’Œç®­å¤´å¼ºåŒ–æ„ŸçŸ¥' },
            { line: 24, text: '// ğŸ’¡ èƒŒæ™¯å¾®èŠ’å…‰æ•ˆï¼ˆBlurï¼‰' },
            { line: 34, text: '// ğŸ’¡ åˆ©ç”¨ Tailwind éå¸¸è½»æ˜“åœ°å®ç°ä¼ä¸šçº§æµå¼ç½‘æ ¼æ¶æ„' },
        ],
    },
    {
        id: 'fe-4-2', type: 'frontend',
        title: 'è¯¾ç¨‹ 4.2ï¼šå¯è§†åŒ–å®æ—¶æ•°æ®',
        category: 'æ¨¡å—4ï¼šSaaS æ´å¯Ÿçœ‹æ¿', track: 'å‰ç«¯æ¶æ„',
        moduleNumber: 4, lessonNumber: 2, language: 'typescript',
        startingCode: '',
        instructions: `# æ¸²æŸ“å›¾è¡¨å¯è§†åŒ–\n\n## ä¸šåŠ¡ä¸Šä¸‹æ–‡\nå…‰æœ‰æ•°å­—ä¸å¤Ÿç›´è§‚ï¼Œè¿˜éœ€è¦æŠ˜çº¿å›¾æ˜¾ç¤ºå¤§ç›˜èµ°åŠ¿ã€‚è¿™é‡Œæˆ‘ä»¬æ‰‹å†™ä¸€ä¸ªéå¸¸è¿·ä½ çš„ SVG æŠ˜çº¿å›¾ç»„ä»¶ï¼Œæ¥ä½“ç°æ•°æ®é©±åŠ¨è§†å›¾çš„é­…åŠ›ã€‚\n\n## å­¦ä¹ ç›®æ ‡\n- ç†è§£æ•°æ®æ•°ç»„å¦‚ä½•æ˜ å°„åˆ° SVG åæ ‡.\n- åŠ¨æ€åœ¨å‰ç«¯ç”Ÿæˆå¯è§†åŒ–å›¾è¡¨ã€‚`,
        targetCode: `import React from 'react';\n\ninterface LineChartProps {\n  data: number[]; // e.g. [10, 20, 15, 40, 30]\n  color?: string;\n}\n\n// ğŸ’¡ ä¸€ä¸ªè½»é‡ã€æ— å¤–éƒ¨ä¾èµ–çš„ SVG å¾®ç¼©æŠ˜çº¿å›¾ (Sparkline)\nexport function Sparkline({ data, color = '#4285F4' }: LineChartProps) {\n  if (data.length === 0) return null;\n\n  const max = Math.max(...data);\n  const min = Math.min(...data);\n  const range = max - min || 1;\n\n  const height = 40;\n  const width = 100;\n  \n  // ğŸ’¡ å°†æ•°ç»„ä¸­çš„å€¼ï¼Œæ˜ å°„åˆ° x/y åæ ‡ä¸Šç”Ÿæˆä¸€æ®µè¿ç»­è·¯å¾„\n  const points = data\n    .map((val, i) => {\n      const x = (i / (data.length - 1)) * width;\n      const y = height - ((val - min) / range) * height;\n      return \`\${x},\${y}\`;\n    })\n    .join(' L ');\n\n  return (\n    <svg viewBox={\`0 0 \${width} \${height}\`} className="w-full h-10 overflow-visible">\n      <path\n        d={\`M \${points}\`}\n        fill="none"\n        stroke={color}\n        strokeWidth="2"\n        strokeLinecap="round"\n        strokeLinejoin="round"\n        className="drop-shadow-sm"\n      />\n    </svg>\n  );\n}\n`,
        comments: [
            { line: 9, text: '// ğŸ’¡ æˆ‘ä»¬ä¸ä»…åªç”¨ç°æˆçš„åº“ï¼Œäº†è§£åº•å±‚çš„æ¸²æŸ“æ€æƒ³è®©ä½ è„±é¢–è€Œå‡º' },
            { line: 19, text: '// ğŸ’¡ æ ¸å¿ƒæ•°å­¦ï¼šæŒ‰ç…§æœ€å¤§/æœ€å°å€¼ç¼©æ”¾ Y è½´åƒç´ æ¯”ä¾‹' },
            { line: 30, text: '// ğŸ’¡ ç”Ÿæˆ SVG Path è·¯å¾„è¯­æ³• M x1,y1 L x2,y2' },
        ],
    },
    {
        id: 'fe-5-1', type: 'frontend',
        title: 'è¯¾ç¨‹ 5.1ï¼šç½‘ç»œæ ¸å¿ƒè®¾æ–½ä¸ Axios æ‹¦æˆªå™¨',
        category: 'æ¨¡å—5ï¼šå‰åç«¯å…¨æ ˆé›†æˆ', track: 'å‰ç«¯æ¶æ„',
        moduleNumber: 5, lessonNumber: 1, language: 'typescript',
        startingCode: '',
        instructions: `# é…ç½®å…¨é“¾è·¯ç½‘ç»œåŸºå»º\n\n## ä¸šåŠ¡ä¸Šä¸‹æ–‡\nåˆ°äº†çœŸæ­£å°†å‰ç«¯å’Œæˆ‘ä»¬çš„ Spring Boot è·‘é€šçš„æ—¶åˆ»ã€‚å½“ JWT Token æ”¾åœ¨å‰ç«¯åï¼Œæ¯æ¬¡å‘è¯·æ±‚éƒ½å¾—æ‰‹åŠ¨åŠ  \`Authorization Header\`ã€‚æ›´éº»çƒ¦çš„æ˜¯ï¼Œå¦‚æœ Token çªç„¶è¿‡æœŸï¼ŒSpring Boot ä¼šè¿”å› 401ï¼Œéš¾é“æˆ‘ä»¬è¦è®©æ¯ä¸ªè¯·æ±‚å•ç‹¬å» try/catch å—ï¼Ÿç»ä¸ã€‚\n\n## å­¦ä¹ ç›®æ ‡\n- å°è£… \`axios\` å®ä¾‹ç»Ÿä¸€ç®¡ç†åŸºç¡€ URLã€‚\n- ç¼–å†™æ‹¦æˆªå™¨ï¼ˆInterceptorsï¼‰å…¨å±€å¤„ç†é‰´æƒä¸é‡å®šå‘ã€‚`,
        targetCode: `import axios from 'axios';\n\n// ğŸ’¡ å»ºç«‹ç»Ÿä¸€å…µç«™ï¼šåˆ©ç”¨ Vite çš„ä»£ç†ï¼Œæˆ‘ä»¬å°†å‘åŒåŸŸåçš„ /api å‘é€æ‰€æœ‰è¯·æ±‚ \nexport const apiClient = axios.create({\n  baseURL: '/api',\n  timeout: 5000,\n});\n\n// ğŸ’¡ è¯·æ±‚æ‹¦æˆªå™¨ï¼šåƒå®‰æ£€å‘˜ï¼Œåœ¨ä»»ä½•è¯·æ±‚å†²å‡ºæµè§ˆå™¨ä¹‹å‰æˆªç•™å®ƒæ‰“ä¸Šçƒ™å°\napiclient.interceptors.request.use(\n  (config) => {\n    // ğŸ’¡ ä» localStorage æå–èº«ä»½ä»¤ç‰Œ\n    const token = localStorage.getItem('jwt');\n    if (token) {\n      // ğŸ’¡ æ³¨å…¥ OAuth2 / JWT è§„èŒƒè¦æ±‚çš„ Bearer æˆæƒå¤´\n      config.headers['Authorization'] = \`Bearer \${token}\`;\n    }\n    return config;\n  },\n  (error) => Promise.reject(error)\n);\n\n// ğŸ’¡ å“åº”æ‹¦æˆªå™¨ï¼šä¸ç®¡ä¸Šå±‚ä¸šåŠ¡åœ¨å¹²å˜›ï¼Œåœ¨è¿™é‡Œå…ˆè¿‡æ»¤æ‰€æœ‰éé¢„æœŸé”™è¯¯\napiclient.interceptors.response.use(\n  (response) => response, // æ­£å¸¸ 200 å°±æ”¾è¡Œ\n  (error) => {\n    if (error.response?.status === 401) {\n      // ğŸ’¡ 401 æ„å‘³ç€ä»¤ç‰Œå·²ç»è¿‡æœŸå¤±æ•ˆï¼Œæˆ‘ä»¬æ— æƒ…åœ°æŠŠç”¨æˆ·è¸¢å›ç™»å½•é¡µ\n      console.error('é‰´æƒå¤±è´¥ï¼Œå³å°†è·³è½¬ç™»å½•...');\n      localStorage.removeItem('jwt');\n      window.location.href = '/login';\n    }\n    return Promise.reject(error);\n  }\n);\n`,
        comments: [
            { line: 4, text: '// ğŸ’¡ æ­é…æˆ‘ä»¬åœ¨ FE 1.1 ä¸­é…çš„ Vite Proxy é£Ÿç”¨æ›´ä½³' },
            { line: 9, text: '// ğŸ’¡ Request å¼ºè¢­è£…ç”²ï¼šä»»ä½•ç»„ä»¶å‘èµ· fetch éƒ½ä¼šæ— æ„Ÿå¸¦ä¸Š Token' },
            { line: 15, text: '// ğŸ’¡ æˆ‘ä»¬å³å°†å‘¼å«åç«¯çš„ JwtRequestFilter' },
            { line: 26, text: '// ğŸ’¡ å…¨å±€å…œåº•ç½‘ç»œæ•…éšœï¼Œæ°¸è¿œä¸è¦è®©ç™½å±æŠ›ç»™ç”¨æˆ·' },
        ],
    },
    {
        id: 'fe-5-2', type: 'frontend',
        title: 'è¯¾ç¨‹ 5.2ï¼šå®æˆ˜å‰åç«¯é—­ç¯è”è°ƒ',
        category: 'æ¨¡å—5ï¼šå‰åç«¯å…¨æ ˆé›†æˆ', track: 'å‰ç«¯æ¶æ„',
        moduleNumber: 5, lessonNumber: 2, language: 'typescript',
        startingCode: '',
        instructions: `# å¯å‘å¼ä»»åŠ¡ï¼šé—­ç¯è”è°ƒ\n\n## ä»»åŠ¡ç›®æ ‡\nè¿™æ˜¯ä½ å‰ç«¯çš„æœ€ç»ˆè€ƒæ ¸ã€‚å°†æˆ‘ä»¬å‰é¢çš„ \`LoginForm\`ã€\`apiClient\` ä»¥åŠ JWT ä»¤ç‰Œä¸²è”ï¼Œå°è¯•è§¦å‘ç™»å½•å¹¶åœ¨æˆåŠŸåè·å–ä½ çš„ä¸ªäººèµ„æ–™ã€‚`,
        targetCode: `import React, { useState } from 'react';\nimport { apiClient } from './apiClient';\n\nexport default function AuthGate() {\n  const [token, setToken] = useState<string | null>(localStorage.getItem('jwt'));\n  const [profile, setProfile] = useState<any>(null);\n\n  const handleLogin = async () => {\n    try {\n      // ğŸ’¡ å‘èµ·ç¡¬æ ¸çš„çœŸå®ç½‘ç»œè¿æ¥ï¼šè°ƒç”¨ Spring Boot çš„ LoginController\n      const res = await apiClient.post('/auth/login', { username: 'admin', password: 'password' });\n      \n      // ğŸ’¡ å­˜å‚¨å‘½è„‰\n      const newToken = res.data.token;\n      localStorage.setItem('jwt', newToken);\n      setToken(newToken);\n\n    } catch (err) {\n      alert('åç«¯æœåŠ¡æœªå¯åŠ¨æˆ–ç”¨æˆ·åé”™è¯¯ï¼');\n    }\n  };\n\n  const fetchSecretProfile = async () => {\n    try {\n      // ğŸ’¡ ç”±äºè®¾ç½®äº†æ‹¦æˆªå™¨ï¼Œè¿™é‡Œå®Œå…¨ä¸ç”¨ç®¡ Tokenï¼Œç›´æ¥è¦æ•°æ®å³å¯ï¼Œéå¸¸æ¸…çˆ½\n      const res = await apiClient.get('/users/profile');\n      setProfile(res.data);\n    } catch (err) {\n      // æ‹¦æˆªå™¨å¦‚æœè¿”å› 401 æˆ‘ä»¬æ—©å°±è¢«é‡å®šå‘è¸¢èµ°äº†ï¼Œä¸éœ€è¦å¤„ç†è¶Šæƒ\n    }\n  };\n\n  return (\n    <div className="p-10 text-center">\n      {!token ? (\n        <button onClick={handleLogin} className="bg-[#34A853] text-white px-8 py-3 rounded-full font-bold shadow-md">\n          å…¨é“¾è·¯ä¸€é”®ç™»å½•\n        </button>\n      ) : (\n        <div className="space-y-4">\n          <p className="text-green-600 font-bold">âœ“ Token ä¿å­˜åœ¨æµè§ˆå™¨ä¸­</p>\n          <button onClick={fetchSecretProfile} className="bg-blue-600 text-white px-6 py-2 rounded shadow flex mx-auto">\n            æŠ“å–åç«¯è¢«ä¿æŠ¤çš„ç”¨æˆ·èµ„æ–™\n          </button>\n          {profile && <pre className="text-left bg-gray-100 p-4 mt-4 text-xs overflow-auto">{JSON.stringify(profile, null, 2)}</pre>}\n        </div>\n      )}\n    </div>\n  );\n}\n`,
        comments: [
            { line: 11, text: '// ğŸ’¡ ç­‰å¾…åç«¯çš„ AuthenticationManager è¿›è¡Œè®¤è¯æ ¡éªŒ' },
            { line: 14, text: '// ğŸ’¡ å°†åç«¯èµäºˆçš„ä»¤ç‰Œæ”¶å…¥å›Šä¸­' },
            { line: 26, text: '// ğŸ’¡ çœ‹çœ‹æ‹¦æˆªå™¨è¿™ä¼˜é›…çš„æŠ½è±¡ï¼šä¸šåŠ¡ä»£ç çº¯ç²¹æç®€' },
        ],
    }
];
